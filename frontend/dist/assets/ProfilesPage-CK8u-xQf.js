import{c as C,d as _,r as c,u as P,j as e,G as u,a as p,A as m}from"./index-MjGtIaAt.js";import{u as k}from"./useMutation-Ckz2NycH.js";import{c as S}from"./utils-BykweIWy.js";import{P as F}from"./plus-Dqq5J1Gg.js";import{I as z}from"./info-BJzi6qvF.js";import{S as E}from"./save-Cgmpexpf.js";import"./clsx-B-dksMZM.js";const G=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],D=C("download",G);function Q(){const g=_(),[a,i]=c.useState(null),[d,l]=c.useState(!1),[t,r]=c.useState({name:"",description:"",model_type:"custom",config_ini:""}),{data:h,isLoading:f}=P({queryKey:["wheel-profiles"],queryFn:async()=>(await p.get(`${m}/control/profiles`)).data}),n=k({mutationFn:async s=>(await p.post(`${m}/control/profiles`,s)).data,onSuccess:()=>{g.invalidateQueries({queryKey:["wheel-profiles"]}),l(!1),r({name:"",description:"",model_type:"custom",config_ini:""})}}),b=s=>{i(null),r({name:"",description:"",model_type:"custom",config_ini:""}),l(!0)},y=s=>{s.preventDefault(),n.mutate(t)},j=s=>{const o=s.target.files?.[0];if(!o)return;const x=new FileReader;x.onload=v=>{const N=v.target?.result;r(w=>({...w,config_ini:N}))},x.readAsText(o)};return e.jsxs("div",{className:"p-6 space-y-6 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-black text-white uppercase tracking-tight flex items-center gap-3",children:[e.jsx(u,{className:"text-blue-500"}),"Perfiles de Volante"]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Gestiona configuraciones de Force Feedback y botones (controls.ini)"})]}),!d&&e.jsxs("button",{onClick:()=>b(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(F,{size:18}),"Nuevo Perfil"]})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-6 min-h-0",children:[e.jsxs("div",{className:"col-span-12 md:col-span-4 lg:col-span-3 bg-gray-900 rounded-2xl border border-gray-800 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-800 bg-gray-900/50",children:e.jsx("h2",{className:"text-xs font-bold text-gray-500 uppercase",children:"Perfiles Guardados"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:f?e.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"Cargando..."}):h?.map(s=>e.jsxs("button",{onClick:()=>{i(s),l(!1)},className:S("w-full text-left p-3 rounded-xl transition-all border border-transparent",a?.id===s.id?"bg-blue-600/10 border-blue-500/50 text-blue-400":"hover:bg-gray-800 text-gray-400"),children:[e.jsx("div",{className:"font-bold text-sm truncate",children:s.name}),e.jsxs("div",{className:"text-[10px] opacity-70 flex justify-between mt-1",children:[e.jsx("span",{className:"uppercase",children:s.model_type}),s.description&&e.jsx("span",{className:"truncate ml-2 max-w-[60%]",children:s.description})]})]},s.id))})]}),e.jsx("div",{className:"col-span-12 md:col-span-8 lg:col-span-9 bg-gray-900 rounded-2xl border border-gray-800 p-6 overflow-y-auto",children:d?e.jsxs("form",{onSubmit:y,className:"space-y-6 max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:a?"Editar Perfil":"Crear Nuevo Perfil"}),e.jsx("button",{type:"button",onClick:()=>{l(!1),i(null)},className:"text-sm text-gray-500 hover:text-white",children:"Cancelar"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Nombre"}),e.jsx("input",{type:"text",required:!0,value:t.name,onChange:s=>r({...t,name:s.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Ej: Logitech G29 Drift"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Tipo de Base"}),e.jsxs("select",{value:t.model_type,onChange:s=>r({...t,model_type:s.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"custom",children:"Personalizado"}),e.jsx("option",{value:"g29",children:"Logitech G29/G920"}),e.jsx("option",{value:"fanatec",children:"Fanatec"}),e.jsx("option",{value:"moza",children:"Moza Racing"}),e.jsx("option",{value:"simucube",children:"Simucube"}),e.jsx("option",{value:"thrustmaster",children:"Thrustmaster"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Descripción"}),e.jsx("input",{type:"text",value:t.description,onChange:s=>r({...t,description:s.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Opcional"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Contenido (controls.ini)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"ini-upload",accept:".ini,.txt",className:"hidden",onChange:j}),e.jsxs("label",{htmlFor:"ini-upload",className:"text-xs bg-gray-800 hover:bg-gray-700 text-blue-400 px-3 py-1.5 rounded-lg cursor-pointer flex items-center gap-1 transition-colors",children:[e.jsx(D,{size:12})," Cargar Archivo"]})]})]}),e.jsx("textarea",{value:t.config_ini,onChange:s=>r({...t,config_ini:s.target.value}),className:"w-full h-96 bg-gray-950 border border-gray-700 rounded-xl p-4 text-xs font-mono text-green-400 focus:ring-2 focus:ring-blue-500 outline-none resize-none",placeholder:"[HEADER]..."}),e.jsxs("p",{className:"text-xs text-gray-600 mt-2 flex items-center gap-1",children:[e.jsx(z,{size:12}),"Copia aquí el contenido de tu archivo controls.ini"]})]}),e.jsx("button",{type:"submit",disabled:n.isPending||!t.name,className:"w-full bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 transition-colors",children:n.isPending?"Guardando...":e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18})," Guardar Perfil"]})})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-blue-500 uppercase mb-1",children:a.model_type}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tight",children:a.name}),a.description&&e.jsx("p",{className:"text-gray-400 mt-1",children:a.description})]}),e.jsx("div",{className:"flex gap-2"})]}),e.jsxs("div",{className:"bg-gray-950 border border-gray-800 rounded-2xl p-4 relative group",children:[e.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{className:"text-xs bg-gray-800 text-gray-300 px-2 py-1 rounded border border-gray-700",onClick:()=>navigator.clipboard.writeText(a.config_ini),children:"Copiar"})}),e.jsx("pre",{className:"text-xs font-mono text-green-500/80 overflow-auto max-h-[600px] whitespace-pre-wrap",children:a.config_ini||"; Sin contenido"})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-600",children:[e.jsx(u,{size:64,className:"mb-4 opacity-20"}),e.jsx("p",{className:"text-sm font-bold",children:"Selecciona un perfil o crea uno nuevo"})]})})]})]})}export{Q as default};
