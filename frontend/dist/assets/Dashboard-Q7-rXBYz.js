import{c as I,a as v,A as N,u as R,j as e,C as E,U as F,r as c,b as O,d as U,L as V}from"./index-MjGtIaAt.js";import{T as H}from"./trending-up-BHF8h5rZ.js";import{C as B}from"./clock-DpL4IKBu.js";import{R as y,X as k}from"./CartesianChart-byA6CRUy.js";import{B as S,a as _,C as Q}from"./BarChart-DzL7O3Yf.js";import{Y as C}from"./YAxis-hjvaWDO6.js";import{T as f}from"./Tooltip-BKNbpHsn.js";import{A as G}from"./award-xLJ3_U0a.js";import{M as X}from"./map-pin-BuEIuJfX.js";import{C as Y}from"./car-Bto1fEN0.js";import{S as Z}from"./star-CL4c2zd3.js";import{P as J,a as W}from"./PieChart-D-40hrae.js";import{L as ee}from"./Legend-DL5FTiQX.js";import{X as se}from"./x-CyrpJdpA.js";import{M as te}from"./monitor-BxVudD1P.js";import{M as ae}from"./MassLaunchModal-BRnv33zS.js";import{R as re}from"./rocket-C4zol-4Y.js";import"./clsx-B-dksMZM.js";import"./graphicalItemSelectors-DfVAs9is.js";import"./PolarChart-BobUyqbt.js";import"./stations-BBBEE_Ei.js";import"./utils-BykweIWy.js";import"./proxy-CbfoYm00.js";import"./index-FSCaKcAl.js";import"./activity-d8XIJMYL.js";import"./map-BRdv7LqT.js";import"./loader-circle-DSpMC2cv.js";const ie=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],le=I("dollar-sign",ie);const oe=[["circle",{cx:"6",cy:"15",r:"4",key:"vux9w4"}],["circle",{cx:"18",cy:"15",r:"4",key:"18o8ve"}],["path",{d:"M14 15a2 2 0 0 0-2-2 2 2 0 0 0-2 2",key:"1ag4bs"}],["path",{d:"M2.5 13 5 7c.7-1.3 1.4-2 3-2",key:"1hm1gs"}],["path",{d:"M21.5 13 19 7c-.7-1.3-1.5-2-3-2",key:"1r31ai"}]],ne=I("glasses",oe),de=async()=>(await v.get(`${N}/stations/stats`)).data,ce=async t=>(await v.post(`${N}/sessions/start`,t)).data,xe={bronze:"#cd7f32",silver:"#c0c0c0",gold:"#ffd700",platinum:"#e5e4e2"};function me(){const{data:t,isLoading:n,error:d}=R({queryKey:["analytics"],queryFn:async()=>(await v.get(`${N}/analytics/overview`)).data,refetchInterval:3e4});if(n)return e.jsx("div",{className:"bg-gray-800 rounded-2xl p-8 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500/20 border-t-blue-500 rounded-full animate-spin"})});if(d||!t)return e.jsx("div",{className:"bg-gray-800 rounded-2xl p-6 text-center text-gray-500",children:e.jsx("p",{children:"No se pudieron cargar los analytics"})});const r=t?.summary||{sessions_today:0,sessions_this_week:0,active_drivers_week:0},i=t?.bookings||{today:0,total:0,pending:0,confirmed:0},l=t?.loyalty||{total_points_issued:0,total_points_redeemed:0,tier_distribution:{}},h=t?.top_drivers||[],m=t?.popular_tracks||[],p=t?.popular_cars||[],b=t?.sessions_per_day||[],g=Object.entries(l.tier_distribution||{}).map(([a,o])=>({name:a.charAt(0).toUpperCase()+a.slice(1),value:o,color:xe[a]||"#gray"}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-black text-white uppercase tracking-tight flex items-center gap-2",children:[e.jsx(H,{className:"text-green-500",size:24}),"Analytics Dashboard"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Actualizado cada 30s"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(j,{label:"Sesiones Hoy",value:r.sessions_today,icon:B,color:"blue"}),e.jsx(j,{label:"Esta Semana",value:r.sessions_this_week,icon:E,color:"green"}),e.jsx(j,{label:"Pilotos Activos",value:r.active_drivers_week,icon:F,color:"purple"}),e.jsx(j,{label:"Reservas Hoy",value:i.today,icon:E,color:"amber"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-2xl p-6",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Sesiones Ãºltimos 14 dÃ­as"}),e.jsx("div",{className:"h-48",children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(S,{data:b,children:[e.jsx(k,{dataKey:"day",tick:{fill:"#6b7280",fontSize:10},axisLine:!1,tickLine:!1}),e.jsx(C,{tick:{fill:"#6b7280",fontSize:10},axisLine:!1,tickLine:!1}),e.jsx(f,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"},labelStyle:{color:"#fff"}}),e.jsx(_,{dataKey:"sessions",fill:"#3b82f6",radius:[4,4,0,0]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"text-yellow-500",size:16}),"Top Pilotos (Este Mes)"]}),e.jsx("div",{className:"space-y-3",children:h.length>0?h.map((a,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900/50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-black text-sm ${o===0?"bg-yellow-500 text-black":o===1?"bg-gray-400 text-black":o===2?"bg-amber-700 text-white":"bg-gray-700 text-gray-400"}`,children:o+1}),e.jsx("span",{className:"font-bold text-white",children:a.name})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-blue-400 font-bold",children:[a.sessions," sesiones"]})})]},a.name)):e.jsx("p",{className:"text-gray-600 text-sm text-center py-4",children:"Sin datos todavÃ­a"})})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(X,{className:"text-green-500",size:16}),"Circuitos Populares"]}),e.jsx("div",{className:"h-48",children:m.length>0?e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(S,{data:m,layout:"vertical",children:[e.jsx(k,{type:"number",tick:{fill:"#6b7280",fontSize:10},axisLine:!1,tickLine:!1}),e.jsx(C,{type:"category",dataKey:"name",tick:{fill:"#9ca3af",fontSize:11},width:120,axisLine:!1,tickLine:!1}),e.jsx(f,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"}}),e.jsx(_,{dataKey:"sessions",fill:"#22c55e",radius:[0,4,4,0]})]})}):e.jsx("p",{className:"text-gray-600 text-sm text-center py-8",children:"Sin datos todavÃ­a"})})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(Y,{className:"text-red-500",size:16}),"Coches Populares"]}),e.jsx("div",{className:"h-48",children:p.length>0?e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(S,{data:p,layout:"vertical",children:[e.jsx(k,{type:"number",tick:{fill:"#6b7280",fontSize:10},axisLine:!1,tickLine:!1}),e.jsx(C,{type:"category",dataKey:"name",tick:{fill:"#9ca3af",fontSize:11},width:120,axisLine:!1,tickLine:!1}),e.jsx(f,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"}}),e.jsx(_,{dataKey:"sessions",fill:"#ef4444",radius:[0,4,4,0]})]})}):e.jsx("p",{className:"text-gray-600 text-sm text-center py-8",children:"Sin datos todavÃ­a"})})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"text-amber-500",size:16}),"DistribuciÃ³n de Niveles"]}),e.jsx("div",{className:"h-48 flex items-center justify-center",children:g.some(a=>a.value>0)?e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(J,{children:[e.jsx(W,{data:g,cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,paddingAngle:2,dataKey:"value",children:g.map((a,o)=>e.jsx(Q,{fill:a.color},`cell-${o}`))}),e.jsx(f,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"}}),e.jsx(ee,{formatter:a=>e.jsx("span",{style:{color:"#9ca3af"},children:a})})]})}):e.jsx("p",{className:"text-gray-600 text-sm text-center",children:"Sin distribuciÃ³n todavÃ­a"})}),e.jsxs("div",{className:"mt-4 flex justify-around text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-black text-green-400",children:l.total_points_issued.toLocaleString()}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:"Puntos Emitidos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-black text-red-400",children:l.total_points_redeemed.toLocaleString()}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:"Puntos Canjeados"})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-900/30 to-purple-900/30 border border-blue-500/20 rounded-2xl p-6",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Resumen Reservas"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-black text-white",children:i.total}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-black text-yellow-400",children:i.pending}),e.jsx("div",{className:"text-xs text-gray-500",children:"Pendientes"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-black text-green-400",children:i.confirmed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Confirmadas"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-black text-blue-400",children:i.today}),e.jsx("div",{className:"text-xs text-gray-500",children:"Hoy"})]})]})]})]})}function j({label:t,value:n,icon:d,color:r}){const i={blue:"bg-blue-500/10 text-blue-400 border-blue-500/20",green:"bg-green-500/10 text-green-400 border-green-500/20",purple:"bg-purple-500/10 text-purple-400 border-purple-500/20",amber:"bg-amber-500/10 text-amber-400 border-amber-500/20"};return e.jsxs("div",{className:`p-4 rounded-xl border ${i[r]}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(d,{size:16}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider opacity-80",children:t})]}),e.jsx("div",{className:"text-3xl font-black",children:n})]})}function ge({stationId:t,stationName:n,initialIsVR:d,onClose:r,onSuccess:i}){const[l,h]=c.useState(15),[m,p]=c.useState(""),[b,g]=c.useState(5),[a,o]=c.useState(!1),[P,T]=c.useState("cash"),[u,z]=c.useState(d||!1),{data:$}=R({queryKey:["settings"],queryFn:async()=>{const s=await v.get(`${N}/settings/`);return Array.isArray(s.data)?s.data:[]},initialData:[]}),A=(s,x)=>{const D=$.find(q=>q.key===s);return D?parseFloat(D.value):x},M=A("pricing_base_15min",5),w=A("pricing_vr_surcharge",2);c.useEffect(()=>{const s=l/15;let x=s*M;u&&(x+=s*w),l===30&&(x-=1),l===60&&(x-=5),g(x)},[l,u,M,w]);const K=async s=>{s.preventDefault(),o(!0);try{await ce({station_id:t,driver_name:m||void 0,duration_minutes:l,price:b,payment_method:P,is_vr:u}),i(),r()}catch{alert("Error al iniciar sesiÃ³n"),o(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:["Nueva SesiÃ³n: ",n]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:e.jsx(se,{size:24})})]}),e.jsxs("form",{onSubmit:K,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex bg-gray-900 rounded-lg p-1 border border-gray-700",children:[e.jsxs("button",{type:"button",onClick:()=>z(!1),className:`flex-1 py-2 rounded-md text-sm font-bold flex items-center justify-center gap-2 transition-all ${u?"text-gray-500 hover:text-gray-300":"bg-gray-700 text-white shadow"}`,children:[e.jsx(te,{size:16})," Pantalla"]}),e.jsxs("button",{type:"button",onClick:()=>z(!0),className:`flex-1 py-2 rounded-md text-sm font-bold flex items-center justify-center gap-2 transition-all ${u?"bg-indigo-600 text-white shadow":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx(ne,{size:16})," VR (+",w,"â‚¬)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"DuraciÃ³n"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[10,15,30,60].map(s=>e.jsxs("button",{type:"button",onClick:()=>h(s),className:`py-2 rounded-lg text-sm font-bold border transition-colors ${l===s?"bg-blue-600 border-blue-500 text-white":"bg-gray-900 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:[s,"m"]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Piloto (Opcional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-2.5 text-gray-500",size:16}),e.jsx("input",{type:"text",placeholder:"Nombre del cliente...",value:m,onChange:s=>p(s.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl py-2 pl-10 pr-4 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Precio (â‚¬)"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-500",size:16}),e.jsx("input",{type:"number",step:"0.50",value:b,onChange:s=>g(Number(s.target.value)),className:"w-full bg-gray-900 border border-gray-700 rounded-xl py-2 pl-10 pr-4 text-white focus:ring-2 focus:ring-green-500 outline-none font-mono font-bold text-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Pago"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{value:P,onChange:s=>T(s.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl py-2.5 px-3 text-white focus:ring-2 focus:ring-purple-500 outline-none appearance-none",children:[e.jsx("option",{value:"cash",children:"ðŸ’µ Efectivo"}),e.jsx("option",{value:"card_nayax",children:"ðŸ’³ TPV / Card"}),e.jsx("option",{value:"online",children:"ðŸŒ Online"})]})})]})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 py-3 rounded-xl font-bold text-gray-400 hover:text-white hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold shadow-lg shadow-green-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Iniciando...":"Cobrar e Iniciar"})]})]})]})})}function Fe(){const t=U(),[n,d]=c.useState(!1),[r,i]=c.useState(null),{data:l,isLoading:h,error:m}=R({queryKey:["dashboardStats"],queryFn:de,refetchInterval:5e3});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>d(!0),className:"block p-5 rounded-xl border border-white/5 bg-white/5 backdrop-blur-sm shadow-lg transition-all duration-300 group hover:-translate-y-1 hover:shadow-xl hover:border-red-500/50 hover:bg-red-500/10 hover:shadow-red-500/10 text-left",children:[e.jsxs("h3",{className:"font-bold text-white mb-1 group-hover:translate-x-1 transition-transform flex items-center gap-2 text-lg",children:[e.jsx(re,{size:20,className:"text-red-500"})," LANZAMIENTO"]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Despliegue masivo en simuladores"})]}),e.jsx(L,{to:"/profiles",title:"Perfiles Volante",desc:"Aplicar FFB y config hardware",color:"blue"}),e.jsx(L,{to:"/events",title:"Organizar Torneo",desc:"Crear eliminatorias y brackets",color:"indigo"}),e.jsx(L,{to:"/championships",title:"Gestionar Campeonato",desc:"Administrar puntos de temporada",color:"purple"})]}),e.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl shadow-xl overflow-hidden text-white"}),e.jsx("div",{className:"mt-10",children:e.jsx(me,{})}),n&&e.jsx(ae,{onClose:()=>d(!1)}),r&&e.jsx(ge,{stationId:r.id,stationName:r.name,initialIsVR:r.is_vr,onClose:()=>i(null),onSuccess:()=>{i(null),t.invalidateQueries({queryKey:["active-sessions"]})}})]})}function L({to:t,title:n,desc:d,color:r}){const i={blue:"hover:border-blue-500/50 hover:bg-blue-500/10 hover:shadow-blue-500/10",indigo:"hover:border-indigo-500/50 hover:bg-indigo-500/10 hover:shadow-indigo-500/10",purple:"hover:border-purple-500/50 hover:bg-purple-500/10 hover:shadow-purple-500/10",green:"hover:border-green-500/50 hover:bg-green-500/10 hover:shadow-green-500/10"};return e.jsxs(V,{to:t,className:`block p-5 rounded-xl border border-white/5 bg-white/5 backdrop-blur-sm shadow-lg transition-all duration-300 group hover:-translate-y-1 hover:shadow-xl ${i[r]}`,children:[e.jsx("h3",{className:"font-bold text-white mb-1 group-hover:translate-x-1 transition-transform",children:n}),e.jsx("p",{className:"text-sm text-gray-400",children:d})]})}export{Fe as default};
