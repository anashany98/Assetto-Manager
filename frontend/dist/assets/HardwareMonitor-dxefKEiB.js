import{c as h,r as j,u,j as e,a as x,A as o,G as w,b as v}from"./index-MjGtIaAt.js";import{c as a}from"./utils-BykweIWy.js";import{R as m}from"./refresh-cw-DQN2a5yv.js";import{T as y}from"./triangle-alert-ko4KflD0.js";import{M as f}from"./monitor-BxVudD1P.js";import{P as _}from"./power-Cer9ZwtD.js";import{M as k}from"./map-pin-BuEIuJfX.js";import{C}from"./car-Bto1fEN0.js";import{C as g}from"./circle-check-big-D_wv1sd6.js";import"./clsx-B-dksMZM.js";const M=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],b=h("circle-x",M);const A=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],P=h("cpu",A);const $=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],N=h("power-off",$);const R=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],E=h("thermometer",R);function i({value:s,color:l,label:n}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-400",children:n}),e.jsxs("span",{className:a(s>90?"text-red-400":s>75?"text-yellow-400":"text-green-400"),children:[s.toFixed(0),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:a("h-full rounded-full transition-all",l),style:{width:`${Math.min(s,100)}%`}})})]})}function q({station:s}){const[l,n]=j.useState(!1),d=async t=>{if(window.confirm(`¿Seguro que quieres ${t==="power-on"?"ENCENDER":t==="shutdown"?"APAGAR":"REINICIAR"} esta estación?`)){n(!0);try{await x.post(`${o}/stations/${s.station_id}/${t}`)}catch(p){console.error("Power action failed",p),alert("Error al ejecutar acción de energía")}finally{n(!1)}}},c=s.alerts.length>0,r=s.is_online?c?"border-yellow-500":"border-green-500":"border-red-500";return e.jsxs("div",{className:a("bg-gray-800/80 rounded-xl p-4 border-2 transition-all",r),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"font-bold text-white",children:s.station_name})]}),e.jsx("div",{className:a("px-2 py-1 rounded-full text-xs font-bold",s.is_online?c?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:s.is_online?c?"⚠️ Alerta":"✅ Online":"❌ Offline"})]}),e.jsx("div",{className:"flex gap-2 mb-4",children:s.is_online?e.jsxs(e.Fragment,{children:[e.jsxs("button",{disabled:l,onClick:()=>d("shutdown"),className:"flex-1 bg-red-600/20 hover:bg-red-600 text-red-400 hover:text-white py-2 rounded-lg text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all border border-red-500/30",children:[e.jsx(N,{size:12})," Apagar"]}),e.jsx("button",{disabled:l,onClick:()=>d("restart"),className:"p-2 bg-blue-600/20 hover:bg-blue-600 text-blue-400 hover:text-white rounded-lg transition-all border border-blue-500/30 flex items-center justify-center",title:"Reiniciar",children:e.jsx(m,{size:12,className:l?"animate-spin":""})})]}):e.jsxs("button",{disabled:l,onClick:()=>d("power-on"),className:"flex-1 bg-green-600 hover:bg-green-500 disabled:opacity-50 text-white py-2 rounded-lg text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all shadow-[0_4px_15px_rgba(22,163,74,0.3)]",children:[e.jsx(_,{size:12})," Encender (WoL)"]})}),s.is_online&&s.ac_running&&e.jsxs("div",{className:"mb-4 p-2 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(w,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-blue-300",children:"AC en ejecución"})]}),s.current_driver&&e.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1 text-gray-300",children:[e.jsx(v,{className:"w-3 h-3"}),e.jsx("span",{children:s.current_driver})]}),s.current_track&&e.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1 text-gray-300",children:[e.jsx(k,{className:"w-3 h-3"}),e.jsx("span",{children:s.current_track})]}),s.current_car&&e.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1 text-gray-300",children:[e.jsx(C,{className:"w-3 h-3"}),e.jsx("span",{children:s.current_car})]})]}),s.is_online&&e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx(i,{value:s.cpu_percent,color:s.cpu_percent>90?"bg-red-500":s.cpu_percent>75?"bg-yellow-500":"bg-green-500",label:"CPU"}),e.jsx(i,{value:s.ram_percent,color:s.ram_percent>90?"bg-red-500":s.ram_percent>80?"bg-yellow-500":"bg-blue-500",label:"RAM"}),e.jsx(i,{value:s.gpu_percent,color:s.gpu_percent>90?"bg-red-500":s.gpu_percent>75?"bg-yellow-500":"bg-purple-500",label:"GPU"}),e.jsx(i,{value:s.disk_percent,color:s.disk_percent>90?"bg-red-500":s.disk_percent>80?"bg-yellow-500":"bg-cyan-500",label:"Disco"}),s.gpu_temp>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm mt-2",children:[e.jsx(E,{className:a("w-4 h-4",s.gpu_temp>85?"text-red-400":s.gpu_temp>75?"text-yellow-400":"text-green-400")}),e.jsx("span",{className:"text-gray-400",children:"GPU Temp:"}),e.jsxs("span",{className:a(s.gpu_temp>85?"text-red-400":s.gpu_temp>75?"text-yellow-400":"text-green-400"),children:[s.gpu_temp,"°C"]})]})]}),s.is_online&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:a("flex items-center gap-1 px-2 py-1 rounded text-xs",s.wheel_connected?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:[s.wheel_connected?e.jsx(g,{className:"w-3 h-3"}):e.jsx(b,{className:"w-3 h-3"}),"Volante"]}),e.jsxs("div",{className:a("flex items-center gap-1 px-2 py-1 rounded text-xs",s.pedals_connected?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:[s.pedals_connected?e.jsx(g,{className:"w-3 h-3"}):e.jsx(b,{className:"w-3 h-3"}),"Pedales"]}),s.shifter_connected&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:[e.jsx(g,{className:"w-3 h-3"}),"Shifter"]})]}),c&&e.jsx("div",{className:"space-y-1",children:s.alerts.map((t,p)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-yellow-400",children:[e.jsx(y,{className:"w-3 h-3"}),t]},p))}),!s.is_online&&s.last_seen&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Última conexión: ",new Date(s.last_seen).toLocaleString("es-ES")]})]})}function H(){const[s,l]=j.useState(!0),{data:n,isLoading:d,refetch:c}=u({queryKey:["hardware-status"],queryFn:async()=>(await x.get(`${o}/hardware/status`)).data,refetchInterval:s?5e3:!1}),{data:r}=u({queryKey:["hardware-summary"],queryFn:async()=>(await x.get(`${o}/hardware/summary`)).data,refetchInterval:s?5e3:!1});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(P,{className:"w-6 h-6 text-blue-400"}),"Monitor de Hardware"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Estado en tiempo real de los simuladores"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:async()=>{if(window.confirm("¿Apagar TODAS las estaciones online?"))try{await Promise.all(n?.filter(t=>t.is_online).map(t=>x.post(`${o}/stations/${t.station_id}/shutdown`))||[]),c()}catch{alert("Error al apagar algunas estaciones")}},className:"px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-sm flex items-center gap-2 transition shadow-lg",children:[e.jsx(N,{className:"w-4 h-4"}),"Apagar TODO"]}),e.jsxs("button",{onClick:()=>l(!s),className:a("px-3 py-2 rounded-lg text-sm flex items-center gap-2 transition",s?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-400"),children:[e.jsx(m,{className:a("w-4 h-4",s&&"animate-spin")}),s?"Auto-refresh ON":"Auto-refresh OFF"]}),e.jsxs("button",{onClick:()=>c(),className:"px-3 py-2 rounded-lg bg-blue-500/20 text-blue-400 text-sm flex items-center gap-2 hover:bg-blue-500/30 transition",children:[e.jsx(m,{className:"w-4 h-4"}),"Actualizar"]})]})]}),r&&(r.with_alerts>0||r.offline>0)&&e.jsxs("div",{className:"bg-red-500/10 border-l-4 border-red-500 p-4 rounded-r flex items-center justify-between animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.2)]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"text-red-500 w-6 h-6 animate-bounce"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-red-500 uppercase tracking-wider text-sm",children:"Atención Requerida"}),e.jsxs("p",{className:"text-sm text-red-300 font-medium",children:[r.with_alerts>0&&`⚠️ ${r.with_alerts} estaciones con alertas de hardware. `,r.offline>0&&`❌ ${r.offline} estaciones desconectadas.`]})]})]}),e.jsx("button",{onClick:()=>window.scrollTo({top:500,behavior:"smooth"}),className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-bold uppercase tracking-widest rounded transition-colors",children:"Ver Detalles"})]}),r&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:r.total_stations}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 text-center border border-green-500/30",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:r.online}),e.jsx("div",{className:"text-sm text-gray-400",children:"Online"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 text-center border border-red-500/30",children:[e.jsx("div",{className:"text-3xl font-bold text-red-400",children:r.offline}),e.jsx("div",{className:"text-sm text-gray-400",children:"Offline"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 text-center border border-yellow-500/30",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:r.with_alerts}),e.jsx("div",{className:"text-sm text-gray-400",children:"Con alertas"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 text-center border border-blue-500/30",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:r.running_ac}),e.jsx("div",{className:"text-sm text-gray-400",children:"Jugando"})]})]}),d?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(m,{className:"w-8 h-8 animate-spin mx-auto mb-2"}),"Cargando estado de estaciones..."]}):n?.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(f,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),"No hay estaciones registradas"]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n?.map(t=>e.jsx(q,{station:t},t.station_id))})]})}export{H as default};
