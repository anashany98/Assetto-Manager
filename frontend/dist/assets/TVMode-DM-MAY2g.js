import{r as j,j as e,u as y,T as D,A,a as O}from"./index-MjGtIaAt.js";import V from"./Leaderboard-7YwXJwZv.js";import{HallOfFame as $}from"./HallOfFame-Dv48601M.js";import{u as z,L as F}from"./useTelemetry-DLtRpw3M.js";import{C as B}from"./clock-DpL4IKBu.js";import{b as q,g as K}from"./events-B0MbDJdO.js";import{T as W}from"./TournamentLeaderboard-3TvuTdkf.js";import{c as H}from"./telemetry-bBsdFDJe.js";import{c as N}from"./utils-BykweIWy.js";import{S as U}from"./swords-BObPOtFC.js";import{m as f}from"./proxy-CbfoYm00.js";import{T as G}from"./TournamentBracket-ovRgnabW.js";import{Q}from"./index-BPWuL58u.js";import{A as P}from"./index-FSCaKcAl.js";import{T as J}from"./triangle-alert-ko4KflD0.js";import"./useMutation-Ckz2NycH.js";import"./x-CyrpJdpA.js";import"./map-pin-BuEIuJfX.js";import"./car-Bto1fEN0.js";import"./check-DDMqjJty.js";import"./TelemetryChart-CrKbnasX.js";import"./loader-circle-DSpMC2cv.js";import"./trending-up-BHF8h5rZ.js";import"./gauge-BmF6m-rA.js";import"./activity-d8XIJMYL.js";import"./CartesianChart-byA6CRUy.js";import"./clsx-B-dksMZM.js";import"./LineChart-BAS0o-Op.js";import"./getRadiusAndStrokeWidthFromDot-hhzSCn0X.js";import"./YAxis-hjvaWDO6.js";import"./Tooltip-BKNbpHsn.js";import"./Legend-DL5FTiQX.js";import"./AreaChart-B6ltY9AV.js";import"./graphicalItemSelectors-DfVAs9is.js";import"./timer-CamBLO3n.js";import"./EloBadge-DKwebwV0.js";import"./refresh-cw-DQN2a5yv.js";import"./medal-9zSXB385.js";function Y({eventName:t,targetDate:l,isActive:r}){const[i,d]=j.useState({days:0,hours:0,minutes:0,seconds:0});return j.useEffect(()=>{const a=setInterval(()=>{const o=new Date().getTime(),c=new Date(l).getTime()-o;c<0?d({days:0,hours:0,minutes:0,seconds:0}):d({days:Math.floor(c/864e5),hours:Math.floor(c%864e5/36e5),minutes:Math.floor(c%36e5/6e4),seconds:Math.floor(c%6e4/1e3)})},1e3);return()=>clearInterval(a)},[l]),e.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-slate-900 text-white p-10 bg-[url('/bg-pattern.png')] bg-cover bg-blend-overlay",children:[e.jsx("div",{className:"mb-8 animate-bounce bg-blue-600 p-4 rounded-full shadow-[0_0_50px_rgba(37,99,235,0.6)]",children:e.jsx(B,{size:64,className:"text-white"})}),e.jsx("h2",{className:"text-3xl md:text-5xl font-black uppercase tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600 mb-4 text-center",children:r?"Evento en Curso":"Próximo Evento"}),e.jsx("h1",{className:"text-5xl md:text-8xl font-black text-white mb-12 text-center drop-shadow-lg",children:t}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 md:gap-12 w-full max-w-4xl",children:[e.jsx(_,{value:i.days,label:"DÍAS"}),e.jsx(_,{value:i.hours,label:"HRS"}),e.jsx(_,{value:i.minutes,label:"MIN"}),e.jsx(_,{value:i.seconds,label:"SEG"})]})]})}function _({value:t,label:l}){return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-gray-800/80 backdrop-blur-md border border-gray-700 w-full aspect-square rounded-2xl flex items-center justify-center shadow-2xl",children:e.jsx("span",{className:"text-4xl md:text-8xl font-mono font-bold text-white tabular-nums",children:t.toString().padStart(2,"0")})}),e.jsx("span",{className:"mt-4 text-sm md:text-xl font-bold text-gray-400 tracking-[0.2em]",children:l})]})}function Z({drivers:t,track:l}){const{data:r,isLoading:i}=y({queryKey:["versus",t,l],queryFn:async()=>t.length<2?null:await H({drivers:t,track:l}),refetchInterval:1e4});if(i)return e.jsx("div",{className:"text-center text-4xl text-white animate-pulse font-black italic mt-40",children:"ANALIZANDO RIVALES..."});if(!r||!r.drivers)return e.jsx("div",{className:"text-center text-red-500 mt-20 text-2xl",children:"Datos insuficientes para el duelo"});const d=r.drivers,a=[...d].sort((n,m)=>n.best_lap-m.best_lap),o=a[0].best_lap,c=t.length===2?"grid-cols-2":t.length===3?"grid-cols-3":"grid-cols-4",p=n=>{const m=["from-blue-600/20 to-blue-900/10 border-blue-500/30","from-red-600/20 to-red-900/10 border-red-500/30","from-green-600/20 to-green-900/10 border-green-500/30","from-yellow-600/20 to-yellow-900/10 border-yellow-500/30"];return m[n%m.length]},u=n=>{const m=["bg-blue-600","bg-red-600","bg-green-600","bg-yellow-600"];return m[n%m.length]};return e.jsxs("div",{className:"h-full w-full bg-gray-950 text-white flex flex-col p-4 md:p-8 overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"}),e.jsxs("header",{className:"text-center mb-8 relative z-10 shrink-0",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-red-600/20 rounded-full mb-2 animate-pulse border border-red-500/50",children:e.jsx(U,{className:"w-12 h-12 text-red-500"})}),e.jsx("h1",{className:"text-5xl md:text-7xl font-black uppercase italic tracking-tighter text-transparent bg-clip-text bg-gradient-to-b from-white to-gray-400",children:"Duelo en la Cima"}),e.jsx("p",{className:"text-2xl text-gray-400 mt-2 font-mono tracking-widest uppercase",children:l})]}),e.jsx("div",{className:N("flex-1 grid gap-4 md:gap-8 relative z-10",c),children:d.map((n,m)=>{const g=n.best_lap===o,b=n.best_lap-o,k=a.findIndex(w=>w.driver_name===n.driver_name)+1;return e.jsxs(f.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:m*.2},className:N("flex flex-col relative rounded-3xl border-2 overflow-hidden bg-gradient-to-b shadow-2xl backdrop-blur-sm",p(m),g?"border-yellow-500 shadow-[0_0_30px_rgba(234,179,8,0.3)] scale-[1.02] z-20":"border-gray-800"),children:[e.jsxs("div",{className:N("absolute top-4 right-4 text-4xl font-black italic opacity-50 z-0",g?"text-yellow-500":"text-gray-600"),children:["P",k]}),e.jsxs("div",{className:"p-6 text-center flex flex-col items-center border-b border-white/5 bg-black/20",children:[e.jsx("div",{className:N("w-32 h-32 md:w-40 md:h-40 rounded-full mb-4 flex items-center justify-center border-4 shadow-lg text-6xl font-bold",u(m),g?"border-yellow-400":"border-white/20"),children:n.driver_name.charAt(0)}),e.jsx("h2",{className:"text-2xl md:text-4xl font-black uppercase italic tracking-tight line-clamp-1",children:n.driver_name})]}),e.jsxs("div",{className:"flex-1 p-6 flex flex-col justify-center space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-gray-500 font-bold mb-1",children:"Mejor Vuelta"}),e.jsx("p",{className:N("text-4xl md:text-5xl font-mono font-bold tracking-tighter",g?"text-yellow-400":"text-white"),children:new Date(n.best_lap).toISOString().substr(14,9)}),!g&&e.jsxs("div",{className:"inline-block bg-red-500/20 px-2 py-0.5 rounded text-red-400 font-mono font-bold text-lg mt-1",children:["+",new Date(b).toISOString().substr(17,6)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-black/30 p-3 rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-gray-500 mb-1",children:"Consistencia"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-300",children:[n.consistency,"ms"]})]}),e.jsxs("div",{className:"bg-black/30 p-3 rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-gray-500 mb-1",children:"Vueltas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-300",children:n.total_laps})]})]})]}),n.win_count>0&&e.jsx("div",{className:"bg-white/5 p-2 flex justify-center space-x-1",children:[...Array(n.win_count)].map((w,v)=>e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"},v))})]},n.driver_name)})})]})}function X({eventId:t,track:l}){const{data:r}=y({queryKey:["event_leaderboard",t],queryFn:()=>q(t)});if(!r||r.length<2)return e.jsx("div",{className:"flex h-full items-center justify-center text-gray-500 text-2xl",children:"Se necesitan al menos 2 pilotos para un duelo."});const i=r.slice(0,4).map(d=>d.driver_name);return e.jsx(Z,{drivers:i,track:l||r[0].track_name})}function ee({data:t}){const r=Math.min(t.rpm/9e3*100,100),i=t.rpm>8e3;return e.jsxs("div",{className:"h-full w-full bg-gradient-to-br from-gray-900 via-black to-gray-900 p-8 grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-yellow-500/20 to-transparent border-l-4 border-yellow-500 p-6 rounded-r-2xl",children:[e.jsx("p",{className:"text-yellow-500 text-xs font-bold uppercase tracking-widest mb-1",children:"Piloto"}),e.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:t.driver||"Desconocido"})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl space-y-2",children:[e.jsx(I,{label:"Coche",value:t.car||"-"}),e.jsx(I,{label:"Circuito",value:t.track||"-"}),e.jsx(I,{label:"Vueltas",value:String(t.laps||0)})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"relative w-72 h-72 mb-8",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"rgba(255,255,255,0.1)",strokeWidth:"8",fill:"none",strokeLinecap:"round",strokeDasharray:"212",strokeDashoffset:"0"}),e.jsx(f.circle,{cx:"50",cy:"50",r:"45",stroke:"url(#speedGradient)",strokeWidth:"8",fill:"none",strokeLinecap:"round",strokeDasharray:"212",initial:{strokeDashoffset:212},animate:{strokeDashoffset:212-t.speed_kmh/350*212},transition:{type:"spring",stiffness:100}}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"speedGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#22c55e"}),e.jsx("stop",{offset:"50%",stopColor:"#eab308"}),e.jsx("stop",{offset:"100%",stopColor:"#ef4444"})]})})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-7xl font-black text-white tabular-nums",children:Math.round(t.speed_kmh)}),e.jsx("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"KM/H"})]})]}),e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:"RPM"}),e.jsx("span",{className:i?"text-red-500 animate-pulse font-bold":"",children:Math.round(t.rpm)})]}),e.jsx("div",{className:"h-4 bg-gray-800 rounded-full overflow-hidden",children:e.jsx(f.div,{className:`h-full rounded-full ${i?"bg-red-500":"bg-gradient-to-r from-green-500 via-yellow-500 to-red-500"}`,initial:{width:0},animate:{width:`${r}%`},transition:{type:"spring",stiffness:150}})})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("span",{className:"text-8xl font-black text-white",children:t.gear===0?"N":t.gear===-1?"R":t.gear}),e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-widest mt-1",children:"Marcha"})]})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center space-y-6",children:[e.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Pedales"}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx(M,{label:"Gas",value:t.gas||0,color:"green"}),e.jsx(M,{label:"Freno",value:t.brake||0,color:"red"})]})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Volante"}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full relative overflow-hidden",children:e.jsx(f.div,{className:"absolute top-0 h-full w-8 bg-blue-500 rounded-full",style:{left:"50%",marginLeft:"-1rem"},animate:{x:(t.steer||0)*50},transition:{type:"spring",stiffness:200}})})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-xl",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Fuerzas G"}),e.jsxs("div",{className:"relative w-24 h-24 mx-auto bg-gray-800 rounded-full",children:[e.jsx(f.div,{className:"absolute w-4 h-4 bg-yellow-500 rounded-full",style:{top:"50%",left:"50%",marginTop:"-0.5rem",marginLeft:"-0.5rem"},animate:{x:(t.g_lat||0)*30,y:(t.g_lon||0)*-30},transition:{type:"spring",stiffness:300}}),e.jsx("div",{className:"absolute inset-0 border-2 border-white/10 rounded-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(S,{label:"Motor",value:t.engine_temp||0,unit:"°C",warning:(t.engine_temp||0)>100}),e.jsx(S,{label:"Fuel",value:t.fuel||0,unit:"L",warning:(t.fuel??100)<5})]})]})]})}function I({label:t,value:l}){return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:t}),e.jsx("span",{className:"text-white font-bold text-sm truncate max-w-[150px]",children:l})]})}function M({label:t,value:l,color:r}){const i=r==="green"?"bg-green-500":"bg-red-500";return e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"h-32 bg-gray-800 rounded-lg relative overflow-hidden",children:e.jsx(f.div,{className:`absolute bottom-0 left-0 right-0 ${i}`,initial:{height:0},animate:{height:`${l*100}%`},transition:{type:"spring",stiffness:200}})}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 uppercase",children:t}),e.jsxs("p",{className:"text-sm font-bold text-white",children:[Math.round(l*100),"%"]})]})}function S({label:t,value:l,unit:r,warning:i}){return e.jsxs("div",{className:`p-3 rounded-xl text-center ${i?"bg-red-500/20 border border-red-500/30":"bg-white/5 border border-white/10"}`,children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest",children:t}),e.jsxs("p",{className:`text-xl font-bold ${i?"text-red-400 animate-pulse":"text-white"}`,children:[Math.round(l),r]})]})}const te=["LEADERBOARD","HALL_OF_FAME","LIVE_MAP","COUNTDOWN","TOURNAMENT","BRACKET","SPONSORSHIP","JOIN_QR","SPY_VIEW","BATTLE_VIEW"],Ke=()=>{const[t,l]=j.useState(0),{liveCars:r}=z(),i=Object.keys(r).length>0,a=new URLSearchParams(window.location.search).get("screen")||"1",{data:o,error:c}=y({queryKey:["events","upcoming"],queryFn:async()=>{const s=await K("upcoming");return Array.isArray(s)?s:[]},refetchInterval:6e4});c&&console.error("Error fetching events:",c);const p=o&&o.length>0?o[0]:null,{data:u}=y({queryKey:["event_active"],queryFn:async()=>(await O.get(`${A}/events/active`)).data,refetchInterval:6e4}),{data:n}=y({queryKey:["settings_tv"],queryFn:async()=>{try{const s=await O.get(`${A}/settings/`);return Array.isArray(s.data)?s.data:[]}catch{return[]}},refetchInterval:2e3,initialData:[]}),m=`tv_mode_${a}`,g=`tv_view_${a}`,b=Array.isArray(n)?n:[],k=b.find(s=>s.key===`tv_interval_${a}`)?.value,w=b.find(s=>s.key===`tv_playlist_${a}`)?.value,v=b.find(s=>s.key===m)?.value||"auto",E=b.find(s=>s.key===g)?.value,L=k?parseInt(k)*1e3:15e3;let h=te.slice();if(w)try{const s=JSON.parse(w);Array.isArray(s)&&s.length>0&&(h=h.filter(x=>s.includes(x)))}catch(s){console.error("Invalid playlist settings",s)}i||(h=h.filter(s=>s!=="LIVE_MAP")),p||(h=h.filter(s=>s!=="COUNTDOWN")),h.length===0&&(h=["LEADERBOARD"]),j.useEffect(()=>{if(v==="manual")return;const s=setInterval(()=>{l(x=>(x+1)%h.length)},L);return()=>clearInterval(s)},[h.length,v,L]),j.useEffect(()=>{},[v,E,h]);const T=v==="manual"&&E?E:h[t],R=()=>{switch(T){case"LEADERBOARD":return e.jsx("div",{className:"h-full w-full overflow-hidden",children:e.jsx(V,{})});case"HALL_OF_FAME":return e.jsx("div",{className:"h-full w-full overflow-hidden",children:e.jsx($,{})});case"LIVE_MAP":return e.jsxs("div",{className:"h-full w-full relative grid grid-cols-12 gap-4 p-8",children:[e.jsx("div",{className:"col-span-8 h-full",children:e.jsx(F,{drivers:Array.isArray(Object.values(r))?Object.values(r).map(s=>({id:Number(s.station_id)||0,name:s.driver||"Desconocido",x:s.x||0,z:s.z||0,normPos:s.normalized_pos||0,color:s.station_id==="1"?"#ef4444":s.station_id==="2"?"#3b82f6":s.station_id==="3"?"#22c55e":"#eab308",isOnline:!0})):[],trackName:Array.isArray(Object.values(r))&&Object.values(r).length>0&&Object.values(r)[0]?.track||"Circuito"})}),e.jsxs("div",{className:"col-span-4 flex flex-col space-y-4 overflow-hidden",children:[e.jsx("h2",{className:"text-xl font-black italic tracking-tighter text-yellow-500 uppercase",children:"Estado de Pista"}),Array.isArray(Object.values(r))&&Object.values(r).slice(0,4).map(s=>e.jsxs("div",{className:"bg-gray-900/80 border-l-4 border-yellow-500 p-4 rounded-r-xl shadow-xl transition-all hover:translate-x-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"font-black text-lg uppercase leading-none tracking-tighter italic",children:s.driver}),e.jsxs("div",{className:"text-[10px] bg-yellow-500 text-black px-1.5 py-0.5 rounded font-black italic",children:[Math.round(s.speed_kmh)," KM/H"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-[8px] uppercase font-bold text-gray-400",children:[e.jsxs("div",{className:"bg-white/5 p-1 px-2 rounded",children:[e.jsx("div",{className:"text-gray-500",children:"Motor"}),e.jsxs("div",{className:s.engine_temp>100?"text-red-500":"text-white",children:[Math.round(s.engine_temp||0),"°C"]})]}),e.jsxs("div",{className:"bg-white/5 p-1 px-2 rounded",children:[e.jsx("div",{className:"text-gray-500",children:"Combustible"}),e.jsxs("div",{className:"text-white",children:[Math.round(s.fuel||0),"L"]})]}),e.jsxs("div",{className:"bg-white/5 p-1 px-2 rounded",children:[e.jsx("div",{className:"text-gray-500",children:"Daño"}),e.jsxs("div",{className:s.damage?.some(x=>x>.1)?"text-red-500":"text-green-500",children:[s.damage?Math.round(s.damage.reduce((x,C)=>x+C,0)*10):0,"%"]})]})]}),e.jsx("div",{className:"mt-2 flex space-x-1 h-1",children:Array.isArray(s.tyre_temp||[0,0,0,0])&&(s.tyre_temp||[0,0,0,0]).map((x,C)=>e.jsx("div",{className:"flex-1 rounded-full",style:{backgroundColor:x>100?"#ef4444":x>80?"#22c55e":"#3b82f6"}},C))})]},s.station_id))]})]});case"COUNTDOWN":return p?e.jsx("div",{className:"h-full w-full",children:e.jsx(Y,{eventName:p.name,targetDate:p.start_date})}):null;case"TOURNAMENT":return u?e.jsx(W,{eventId:u.id,eventName:u.name,description:u.description}):e.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"w-24 h-24 text-gray-700 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl text-gray-500",children:"No hay torneo activo"})]})});case"BRACKET":return u?e.jsxs("div",{className:"h-full w-full p-8 flex flex-col",children:[e.jsxs("h2",{className:"text-3xl font-black text-yellow-500 text-center uppercase tracking-widest mb-4",children:["Fase Eliminatoria: ",u.name]}),e.jsx("div",{className:"flex-1 bg-gray-900/50 rounded-2xl border border-white/10 overflow-hidden",children:e.jsx(G,{eventId:u.id,isAdmin:!1})})]}):null;case"VERSUS":return u?e.jsx(X,{eventId:u.id,track:u.track_name}):null;case"SPONSORSHIP":return e.jsx(se,{});case"JOIN_QR":{const s=b.find(x=>x.key==="bar_public_url")?.value||window.location.origin+"/mobile";return e.jsx(re,{url:s})}case"SPY_VIEW":{const s=Object.values(r);if(s.length===0)return e.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 border-4 border-yellow-500/30 border-t-yellow-500 rounded-full animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-500 uppercase tracking-widest",children:"Esperando Telemetría"}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Conecta un simulador con un piloto activo"})]})});const x=s[0];return e.jsx(ae,{data:x})}case"BATTLE_VIEW":{const s=Object.values(r).slice(0,4);return s.length<2?e.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 border-4 border-red-500/30 border-t-red-500 rounded-full animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-500 uppercase tracking-widest",children:"Esperando Contendientes"}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Se necesitan al menos 2 pilotos activos"})]})}):e.jsx(le,{drivers:s})}default:return e.jsx("div",{className:"h-full w-full flex items-center justify-center bg-black",children:c?e.jsxs("div",{className:"text-center text-red-500",children:[e.jsx(J,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"font-bold uppercase tracking-widest text-xs",children:"Error de Conexión"})]}):e.jsx("div",{className:"text-center animate-pulse",children:e.jsx("img",{src:"/logo.png",className:"w-32 opacity-50 mx-auto",alt:"Logo"})})})}};return e.jsxs("div",{className:"h-screen w-screen bg-black overflow-hidden relative text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900 to-black z-0 pointer-events-none"}),e.jsx(P,{mode:"wait",children:e.jsx(f.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},transition:{duration:.8,ease:"easeInOut"},className:"h-full w-full relative z-10 pt-10",children:R()},T)}),e.jsxs("div",{className:"absolute top-4 right-4 z-50 opacity-30 text-[10px] uppercase font-bold text-white border border-white/30 px-2 py-0.5 rounded",children:["PANTALLA ",a]})]})};function se(){const{data:t,isLoading:l}=y({queryKey:["ads","active"],queryFn:async()=>(await O.get(`${A}/ads/active`)).data,refetchInterval:3e4}),[r,i]=j.useState(0);if(j.useEffect(()=>{if(!t||t.length===0)return;const a=(t?.[r]?.display_duration||10)*1e3,o=setTimeout(()=>{i(c=>(c+1)%t.length)},a);return()=>clearTimeout(o)},[r,t]),l)return null;if(!t||t.length===0)return e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{className:"text-gray-600 uppercase tracking-widest font-bold",children:"Espacio Publicitario Disponible"})});const d=t[r];return e.jsx("div",{className:"h-full w-full relative",children:e.jsx(P,{mode:"wait",children:e.jsxs(f.div,{initial:{opacity:0,scale:1.05},animate:{opacity:1,scale:1},exit:{opacity:0},transition:{duration:1},className:"absolute inset-0",children:[e.jsx("img",{src:`${A}/static/${d.image_path}`,className:"w-full h-full object-cover",alt:d.title}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex flex-col justify-end p-12",children:e.jsx("h2",{className:"text-4xl md:text-6xl font-black text-white uppercase tracking-tighter mb-2 drop-shadow-lg",children:d.title})})]},d.id)})})}function re({url:t}){return e.jsxs("div",{className:"h-full w-full flex items-center justify-center bg-gray-900 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-blue-600 rounded-full blur-[100px] -translate-x-1/2 -translate-y-1/2"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-purple-600 rounded-full blur-[100px] translate-x-1/2 translate-y-1/2"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center gap-12 p-8 max-w-6xl w-full",children:[e.jsxs("div",{className:"flex-1 text-center md:text-left space-y-6",children:[e.jsx("div",{className:"inline-block px-4 py-1 rounded-full bg-blue-500/20 text-blue-400 font-bold uppercase tracking-widest text-sm mb-2 border border-blue-500/30",children:"Portal del Piloto"}),e.jsxs("h1",{className:"text-5xl md:text-7xl font-black text-white uppercase tracking-tighter leading-none",children:["Únete a la ",e.jsx("br",{})," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400",children:"Carrera"})]}),e.jsx("p",{className:"text-xl text-gray-400 max-w-lg",children:"Escanea el código para ver tus estadísticas en tiempo real, comparar tiempos y acceder a tu pasaporte de piloto."}),e.jsxs("div",{className:"flex items-center space-x-4 justify-center md:justify-start pt-4",children:[e.jsxs("div",{className:"flex -space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 border-2 border-gray-900"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-600 border-2 border-gray-900"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-500 border-2 border-gray-900 flex items-center justify-center text-[10px] font-bold text-gray-900",children:"+50"})]}),e.jsx("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Pilotos Conectados"})]})]}),e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsxs("div",{className:"p-8 bg-white rounded-3xl shadow-2xl shadow-blue-500/20 transform rotate-3 transition-transform hover:rotate-0 duration-500",children:[e.jsx(Q,{value:t,size:300,level:"H",imageSettings:{src:"/logo.png",x:void 0,y:void 0,height:40,width:40,excavate:!0}}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("p",{className:"text-black font-black text-xl uppercase tracking-widest",children:"Escanéame"})})]})})]})]})}function ae({data:t}){return e.jsx("div",{className:"h-full w-full",children:e.jsx(ee,{data:t})})}function le({drivers:t}){const l=[{bg:"from-blue-600/20 to-blue-900/10",border:"border-blue-500",text:"text-blue-400",label:"BLUE"},{bg:"from-red-600/20 to-red-900/10",border:"border-red-500",text:"text-red-400",label:"RED"},{bg:"from-green-600/20 to-green-900/10",border:"border-green-500",text:"text-green-400",label:"GREEN"},{bg:"from-yellow-600/20 to-yellow-900/10",border:"border-yellow-500",text:"text-yellow-400",label:"YELLOW"}],r=t.reduce((a,o)=>(o.speed_kmh||0)>(a.speed_kmh||0)?o:a),i=(t.length<=2,"grid-cols-2"),d=t.length<=2?"":"grid-rows-2";return e.jsxs("div",{className:"h-full w-full bg-gray-950 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"}),e.jsxs("header",{className:"absolute top-0 left-0 right-0 z-30 p-4 flex justify-between items-center bg-black/50 backdrop-blur-sm border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("h1",{className:"text-2xl font-black uppercase tracking-tighter italic",children:"Battle Mode"})]}),e.jsxs("div",{className:"text-sm font-mono text-gray-400 uppercase tracking-widest",children:[t.length," PILOTOS ACTIVOS"]})]}),e.jsx("div",{className:`h-full pt-16 grid ${i} ${d} gap-1`,children:t.map((a,o)=>{const c=l[o%l.length],p=a.station_id===r.station_id;return e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:o*.1},className:`relative bg-gradient-to-br ${c.bg} border-l-4 ${c.border} p-6 flex flex-col justify-between overflow-hidden`,children:[e.jsx("div",{className:`absolute top-4 right-4 text-6xl font-black italic opacity-20 ${c.text}`,children:o+1}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-xs font-bold uppercase tracking-widest ${c.text} mb-1`,children:[c.label," CORNER"]}),e.jsx("h2",{className:"text-3xl font-black uppercase tracking-tighter text-white truncate",children:a.driver||"PILOTO"}),e.jsx("p",{className:"text-sm text-gray-500 font-mono truncate",children:a.car||"-"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-7xl font-black tabular-nums ${p?"text-yellow-400":"text-white"}`,children:Math.round(a.speed_kmh||0)}),e.jsx("div",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"KM/H"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-black/30 p-2 rounded-lg",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:"RPM"}),e.jsx("div",{className:"text-lg font-bold font-mono",children:Math.round(a.rpm||0)})]}),e.jsxs("div",{className:"bg-black/30 p-2 rounded-lg",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:"Marcha"}),e.jsx("div",{className:"text-lg font-bold",children:a.gear===0?"N":a.gear===-1?"R":a.gear})]}),e.jsxs("div",{className:"bg-black/30 p-2 rounded-lg",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:"Vuelta"}),e.jsx("div",{className:"text-lg font-bold",children:a.laps||0})]})]}),p&&e.jsx("div",{className:"absolute bottom-4 right-4 bg-yellow-500 text-black px-3 py-1 rounded-full text-xs font-black uppercase",children:"LÍDER"})]},a.station_id)})})]})}export{Ke as TVMode};
