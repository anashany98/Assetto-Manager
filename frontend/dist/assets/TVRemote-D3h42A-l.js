import{c as A,l as C,d as T,p as M,r as E,u as L,j as e,M as P,m as I,o as V,T as D,a as v,A as w}from"./index-MjGtIaAt.js";import $ from"./Leaderboard-7YwXJwZv.js";import{HallOfFame as z}from"./HallOfFame-Dv48601M.js";import{u as U,L as F}from"./useTelemetry-DLtRpw3M.js";import{u as B}from"./useMutation-Ckz2NycH.js";import{c as n}from"./utils-BykweIWy.js";import{A as H}from"./arrow-left-PwRceB5D.js";import{Z as h}from"./zap-BctN5ITw.js";import{M as Q}from"./map-BRdv7LqT.js";import{S as J}from"./swords-BObPOtFC.js";import{T as K}from"./timer-CamBLO3n.js";import{Q as O}from"./qr-code-B6KORoVk.js";import{M as q}from"./megaphone-DzGt9wNw.js";import"./index-BPWuL58u.js";import"./telemetry-bBsdFDJe.js";import"./index-FSCaKcAl.js";import"./proxy-CbfoYm00.js";import"./clock-DpL4IKBu.js";import"./x-CyrpJdpA.js";import"./map-pin-BuEIuJfX.js";import"./car-Bto1fEN0.js";import"./check-DDMqjJty.js";import"./TelemetryChart-CrKbnasX.js";import"./loader-circle-DSpMC2cv.js";import"./trending-up-BHF8h5rZ.js";import"./gauge-BmF6m-rA.js";import"./activity-d8XIJMYL.js";import"./CartesianChart-byA6CRUy.js";import"./clsx-B-dksMZM.js";import"./LineChart-BAS0o-Op.js";import"./getRadiusAndStrokeWidthFromDot-hhzSCn0X.js";import"./YAxis-hjvaWDO6.js";import"./Tooltip-BKNbpHsn.js";import"./Legend-DL5FTiQX.js";import"./AreaChart-B6ltY9AV.js";import"./graphicalItemSelectors-DfVAs9is.js";import"./EloBadge-DKwebwV0.js";import"./triangle-alert-ko4KflD0.js";import"./refresh-cw-DQN2a5yv.js";import"./medal-9zSXB385.js";const W=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],G=A("git-merge",W);const Z=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],R=A("store",Z);const X=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],Y=A("tv",X);function Ue(){const r=C(),g=T(),{token:l}=M(),[a,y]=E.useState(1),[s,k]=E.useState(""),{data:_}=L({queryKey:["settings"],queryFn:async()=>{if(!l)return[];try{const t=await v.get(`${w}/settings/`,{headers:{Authorization:`Bearer ${l}`}});return Array.isArray(t.data)?t.data:[]}catch{return[]}},refetchInterval:2e3,initialData:[],enabled:!!l}),p=(t,b)=>{const d=Array.isArray(_)?_:[],f=`${t}_${a}`;return d.find(j=>j.key===f)?.value||b},i=p("tv_mode","auto"),o=p("tv_view","LEADERBOARD"),u=B({mutationFn:async({key:t,value:b})=>(await v.post(`${w}/settings/`,{key:t,value:b},{headers:{Authorization:`Bearer ${l}`}})).data,onSuccess:()=>{g.invalidateQueries({queryKey:["settings"]})},onError:t=>{console.error("Error updating setting:",t),k("Error de red al actualizar"),setTimeout(()=>k(""),3e3)}}),N=t=>{u.mutate({key:`tv_mode_${a}`,value:t})},c=t=>{u.mutate({key:`tv_view_${a}`,value:t}),i==="auto"&&N("manual")};return e.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-4 pb-20 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("header",{className:"flex justify-between items-center mb-6 md:mb-8",children:e.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[e.jsx("button",{onClick:()=>r("/"),className:"p-2 hover:bg-gray-800 rounded-lg active:scale-95 transition-transform",children:e.jsx(H,{size:24})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl md:text-2xl font-bold flex items-center",children:[e.jsx(Y,{className:"mr-2 md:mr-3 text-blue-500",size:24}),"Mando TV"]}),e.jsx("p",{className:"text-gray-400 text-xs md:text-sm",children:"Control de Pantallas"})]})]})}),s&&e.jsx("div",{className:"bg-red-500/10 text-red-500 p-4 rounded-xl mb-6 text-center text-sm font-bold uppercase tracking-wider border border-red-500/20",children:s}),e.jsx("div",{className:"flex space-x-2 mb-6 bg-gray-800 p-1.5 rounded-xl",children:[1,2,3].map(t=>e.jsxs("button",{onClick:()=>y(t),className:n("flex-1 py-3 rounded-lg font-bold text-sm md:text-base transition-all",a===t?"bg-blue-600 text-white shadow":"text-gray-400 hover:text-white hover:bg-gray-700"),children:["Pantalla ",t]},t))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-4 mb-6 md:mb-8",children:[e.jsxs("button",{onClick:()=>N("auto"),className:n("p-4 md:p-6 rounded-2xl border-2 transition-all flex flex-col items-center justify-center space-y-2 active:scale-95",i==="auto"?"bg-blue-600 border-blue-500 shadow-lg shadow-blue-500/20":"bg-gray-800 border-gray-700 hover:bg-gray-750"),children:[e.jsx(h,{size:28,className:n("md:w-8 md:h-8",i==="auto"?"text-yellow-300 animate-pulse":"text-gray-500")}),e.jsx("span",{className:"font-bold text-base md:text-lg",children:"Automático"}),e.jsx("span",{className:"text-[10px] md:text-xs opacity-70",children:"Rota cada 30s"})]}),e.jsxs("button",{onClick:()=>N("manual"),className:n("p-4 md:p-6 rounded-2xl border-2 transition-all flex flex-col items-center justify-center space-y-2 active:scale-95",i==="manual"?"bg-purple-600 border-purple-500 shadow-lg shadow-purple-500/20":"bg-gray-800 border-gray-700 hover:bg-gray-750"),children:[e.jsx(P,{size:28,className:n("md:w-8 md:h-8",i==="manual"?"text-white":"text-gray-500")}),e.jsx("span",{className:"font-bold text-base md:text-lg",children:"Manual"}),e.jsx("span",{className:"text-[10px] md:text-xs opacity-70",children:"Control total"})]})]}),e.jsxs("div",{className:n("bg-gray-800/50 rounded-3xl p-4 md:p-6 border border-gray-700 transition-all duration-300 mb-6",i==="auto"?"opacity-100":"hidden"),children:[e.jsxs("h2",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(h,{size:14,className:"text-yellow-400"})," Configuración Automática"]}),e.jsxs("div",{className:"mb-6 bg-gray-900/50 p-4 rounded-xl border border-gray-700/50",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-bold text-gray-300",children:"Intervalo de Rotación"}),e.jsxs("span",{className:"text-sm font-mono text-blue-400",children:[p("tv_interval","15")," segundos"]})]}),e.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:p("tv_interval","15"),onChange:t=>u.mutate({key:`tv_interval_${a}`,value:t.target.value}),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),e.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mt-1 uppercase font-bold",children:[e.jsx("span",{children:"Rápido (5s)"}),e.jsx("span",{children:"Normal (30s)"}),e.jsx("span",{children:"Lento (60s)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-bold text-gray-300 mb-3 block",children:"Vistas en Rotación"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["LEADERBOARD","HALL_OF_FAME","LIVE_MAP","TOURNAMENT","BRACKET","COUNTDOWN","SPONSORSHIP","JOIN_QR"].map(t=>{const b=p("tv_playlist","[]");let d=[];try{d=JSON.parse(b)}catch{}!Array.isArray(d)||d.length;const f=d.length===0||d.includes(t),j=()=>{let m=[...d];m.length===0&&(m=["LEADERBOARD","HALL_OF_FAME","LIVE_MAP","TOURNAMENT","BRACKET","COUNTDOWN","SPONSORSHIP","JOIN_QR"]),m.includes(t)?m=m.filter(S=>S!==t):m.push(t),u.mutate({key:`tv_playlist_${a}`,value:JSON.stringify(m)})};return e.jsxs("button",{onClick:j,className:n("flex items-center justify-between p-3 rounded-xl border transition-all text-xs font-bold uppercase tracking-wider",f?"bg-blue-600/10 border-blue-500/50 text-blue-300":"bg-gray-800 border-gray-700 text-gray-500 hover:bg-gray-700"),children:[e.jsx("span",{children:t.replace(/_/g," ")}),e.jsx("div",{className:n("w-3 h-3 rounded-full border",f?"bg-blue-500 border-blue-400":"bg-transparent border-gray-600")})]},t)})})]})]}),e.jsxs("div",{className:n("bg-gray-800/50 rounded-3xl p-4 md:p-6 border border-gray-700 transition-all duration-300",i==="auto"?"opacity-50 pointer-events-none grayscale":"opacity-100"),children:[e.jsxs("h2",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-4",children:["Seleccionar Vista (Pantalla ",a,")"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsx(x,{active:o==="LEADERBOARD",onClick:()=>c("LEADERBOARD"),icon:I,label:"Leaderboard",color:"blue"}),e.jsx(x,{active:o==="HALL_OF_FAME",onClick:()=>c("HALL_OF_FAME"),icon:V,label:"Salón Fama",color:"yellow"}),e.jsx(x,{active:o==="LIVE_MAP",onClick:()=>c("LIVE_MAP"),icon:Q,label:"Mapa en Vivo",color:"red"}),e.jsx(x,{active:o==="TOURNAMENT",onClick:()=>c("TOURNAMENT"),icon:D,label:"Torneo",color:"green"}),e.jsx(x,{active:o==="VERSUS",onClick:()=>c("VERSUS"),icon:J,label:"Duelo",color:"purple"}),e.jsx(x,{active:o==="BRACKET",onClick:()=>c("BRACKET"),icon:G,label:"Eliminatoria",color:"orange"}),e.jsx(x,{active:o==="COUNTDOWN",onClick:()=>c("COUNTDOWN"),icon:K,label:"Cuenta Atrás",color:"cyan"}),e.jsx(x,{active:o==="SPONSORSHIP",onClick:()=>c("SPONSORSHIP"),icon:R,label:"Publicidad",color:"pink"}),e.jsx(x,{active:o==="JOIN_QR",onClick:()=>c("JOIN_QR"),icon:O,label:"Portal QR",color:"indigo"})]})]}),e.jsxs("div",{className:"mt-8 bg-blue-900/20 border border-blue-500/30 rounded-3xl p-6",children:[e.jsxs("h2",{className:"text-blue-400 text-xs font-bold uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(q,{size:14})," Noticias de Última Hora"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Escribe un mensaje urgente...",className:"flex-1 bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500 outline-none text-white",value:p("news_urgent",""),onChange:t=>u.mutate({key:`news_urgent_${a}`,value:t.target.value})}),e.jsx("button",{onClick:()=>u.mutate({key:`news_urgent_${a}`,value:""}),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-xl text-xs font-bold uppercase transition-all",children:"Limpiar"})]}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-2 font-mono uppercase",children:"Este mensaje aparecerá con prioridad en el ticker de la TV."})]}),e.jsxs("div",{className:"mt-8 bg-red-900/20 border border-red-500/30 rounded-3xl p-6",children:[e.jsxs("h2",{className:"text-red-500 text-xs font-bold uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(h,{size:14})," Zona de Peligro"]}),e.jsxs("button",{onClick:async()=>{if(confirm(`⚠ ¿ESTÁS SEGURO?

Esto matará inmediatamente todos los procesos de juego en la PANTALLA ${a}.

Úsalo solo si el simulador se ha colgado.`))try{await v.post(`${w}/stations/${a}/panic`,{},{headers:{Authorization:`Bearer ${l}`}}),alert(`Comando de emergencia enviado a Pantalla ${a}`)}catch{alert("Error al enviar comando de pánico")}},className:"w-full bg-red-600 hover:bg-red-700 text-white font-black py-4 rounded-xl shadow-lg shadow-red-600/20 flex items-center justify-center space-x-3 active:scale-95 transition-all",children:[e.jsx(h,{size:24,className:"animate-pulse"}),e.jsx("span",{children:"INTERRUPTOR DE EMERGENCIA (PANIC)"})]}),e.jsx("p",{className:"text-center text-red-400/60 text-[10px] mt-2 font-mono",children:"Fuerza el cierre de acs.exe, content_manager.exe y steam.exe en la estación remota."})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"bg-black rounded-lg aspect-video w-full max-w-sm mx-auto border-4 border-gray-800 relative flex items-center justify-center overflow-hidden shadow-2xl",children:[e.jsx(ee,{view:o,mode:i}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/80 backdrop-blur px-2 py-1 rounded text-[10px] text-gray-400 font-mono border border-white/10",children:["PANTALLA ",a,": ",i==="auto"?"AUTO":o]})]}),e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:["Vista previa - Pantalla ",a]})]})]})})}function ee({view:r,mode:g}){const{liveCars:l}=U();let a=e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Cargando vista..."});if((g==="auto"?"ROTATION":r)==="ROTATION")return e.jsxs("div",{className:"w-full h-full bg-gray-900 flex flex-col items-center justify-center text-center p-4",children:[e.jsx(h,{className:"w-12 h-12 text-yellow-400 mb-2 animate-pulse"}),e.jsx("p",{className:"text-white font-bold",children:"Modo Automático"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Rotando entre vistas cada 30s"})]});switch(r){case"LEADERBOARD":a=e.jsx($,{});break;case"HALL_OF_FAME":a=e.jsx(z,{});break;case"LIVE_MAP":a=e.jsx(F,{drivers:Array.isArray(Object.values(l))?Object.values(l).map(s=>({id:Number(s.station_id)||0,name:s.driver||"Desconocido",x:s.x||0,z:s.z||0,normPos:s.normalized_pos||0,color:s.station_id==="1"?"#ef4444":s.station_id==="2"?"#3b82f6":s.station_id==="3"?"#22c55e":"#eab308",isOnline:!0})):[],trackName:"Circuito"});break;case"TOURNAMENT":a=e.jsx("div",{className:"p-4",children:e.jsx("p",{className:"text-white text-center",children:"Torneo Activo"})});break;case"VERSUS":a=e.jsx("div",{className:"p-4",children:e.jsx("p",{className:"text-white text-center",children:"Duelo VS"})});break;case"SPONSORSHIP":a=e.jsxs("div",{className:"p-4 flex flex-col items-center justify-center h-full",children:[e.jsx(R,{className:"mb-2 text-pink-500"}),e.jsx("p",{className:"text-white text-center font-bold",children:"ADS"})]});break;case"JOIN_QR":a=e.jsxs("div",{className:"p-4 flex flex-col items-center justify-center h-full",children:[e.jsx(O,{className:"mb-2 text-indigo-500"}),e.jsx("p",{className:"text-white text-center font-bold",children:"QR"})]});break}return e.jsx("div",{className:"w-full h-full overflow-hidden relative bg-black",children:e.jsx("div",{className:"absolute inset-0 origin-top-left transform scale-[0.25] w-[400%] h-[400%] pointer-events-none",children:a})})}function x({active:r,onClick:g,icon:l,label:a,color:y}){const s={blue:r?"bg-blue-600 ring-blue-500":"hover:bg-blue-600/20 text-blue-400",yellow:r?"bg-yellow-600 ring-yellow-500":"hover:bg-yellow-600/20 text-yellow-400",red:r?"bg-red-600 ring-red-500":"hover:bg-red-600/20 text-red-400",green:r?"bg-green-600 ring-green-500":"hover:bg-green-600/20 text-green-400",purple:r?"bg-purple-600 ring-purple-500":"hover:bg-purple-600/20 text-purple-400",orange:r?"bg-orange-600 ring-orange-500":"hover:bg-orange-600/20 text-orange-400",cyan:r?"bg-cyan-600 ring-cyan-500":"hover:bg-cyan-600/20 text-cyan-400",pink:r?"bg-pink-600 ring-pink-500":"hover:bg-pink-600/20 text-pink-400",indigo:r?"bg-indigo-600 ring-indigo-500":"hover:bg-indigo-600/20 text-indigo-400"};return e.jsxs("button",{onClick:g,className:n("p-4 rounded-xl border border-gray-700 flex flex-col items-center space-y-3 transition-all active:scale-95",r?"ring-2 text-white shadow-lg scale-105 border-transparent":"bg-gray-800 text-gray-300",s[y]),children:[e.jsx(l,{size:24}),e.jsx("span",{className:"font-medium text-sm",children:a})]})}export{Ue as default};
