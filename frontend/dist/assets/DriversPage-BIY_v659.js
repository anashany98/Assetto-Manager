import{a as g,A as b,u as h,r as f,d as y,j as e,b as o,L as j,T as v,k as N}from"./index-MjGtIaAt.js";import{u as w}from"./useMutation-Ckz2NycH.js";import{g as k}from"./telemetry-bBsdFDJe.js";import{T as z}from"./triangle-alert-ko4KflD0.js";import{S as _}from"./search-l6nyBgHJ.js";import{M as C}from"./medal-9zSXB385.js";import{C as S}from"./car-Bto1fEN0.js";import{f as A}from"./formatDistanceToNow-DmnD85dQ.js";import{C as L}from"./clock-DpL4IKBu.js";import{a as D}from"./es-D4NFJ41N.js";import"./en-US-BI35v3bL.js";const E=async(s=!1)=>(await g.post(`${b}/integrations/vms/sync`,{dry_run:s})).data;function K(){const{data:s,isLoading:i,error:d}=h({queryKey:["drivers"],queryFn:k}),[l,x]=f.useState(""),m=y(),{mutate:p,isPending:n}=w({mutationFn:()=>E(),onSuccess:r=>{alert(`Sincronización completada:
Encontrados: ${r.users_found}
Creados: ${r.users_created}
Actualizados: ${r.users_updated}`),m.invalidateQueries({queryKey:["drivers"]})},onError:()=>alert("Error al sincronizar con VMS")});if(i)return e.jsxs("div",{className:"p-10 text-center text-white flex flex-col items-center justify-center min-h-[400px]",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-blue-500/20 border-t-blue-500 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"font-bold text-blue-500 animate-pulse uppercase tracking-widest text-sm",children:"Cargando pilotos..."})]});if(d)return e.jsxs("div",{className:"p-10 text-center text-white flex flex-col items-center justify-center min-h-[400px]",children:[e.jsx(z,{size:48,className:"text-red-500 mb-4"}),e.jsx("p",{className:"font-bold text-red-500 uppercase tracking-widest text-sm",children:"Error al cargar la base de datos de pilotos"}),e.jsx("p",{className:"text-gray-500 text-xs mt-2 font-medium",children:"No se ha podido establecer conexión con el servidor."})]});const t=Array.isArray(s)?s:[],c=t.filter(r=>r.driver_name.toLowerCase().includes(l.toLowerCase())),u=r=>{switch(r){case"Alien":return"text-purple-600 bg-purple-100 border-purple-200";case"Pro":return"text-blue-600 bg-blue-100 border-blue-200";case"Amateur":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}};return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-white italic uppercase tracking-tight",children:"Pilotos y Licencias"}),e.jsx("p",{className:"text-gray-400 mt-1 font-bold",children:"Base de datos de corredores registrados"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>p(),disabled:n,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white px-4 py-2 rounded-xl font-bold flex items-center gap-2 transition-colors shadow-lg shadow-blue-600/20",children:[e.jsx(o,{size:18})," ",n?"Sincronizando...":"Sincronizar VMS"]}),e.jsxs("div",{className:"relative w-72",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Buscar piloto...",className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none text-white placeholder-gray-500 font-medium",value:l,onChange:r=>x(r.target.value)})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.isArray(t)&&t.length>0?c.map((r,a)=>e.jsxs(j,{to:`/drivers/${r.driver_name}`,className:"bg-gray-800 p-6 rounded-2xl shadow-lg border border-gray-700 hover:shadow-xl hover:border-gray-500 transition-all group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-900 rounded-xl flex items-center justify-center text-white font-black text-lg shadow-lg border border-gray-600",children:r.driver_name?.charAt(0).toUpperCase()||"?"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-lg text-white group-hover:text-blue-400 transition-colors uppercase tracking-tight",children:r.driver_name}),e.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-0.5 rounded-full border ${u(r.rank_tier)}`,children:r.rank_tier})]})]}),a<3&&e.jsx(C,{size:24,className:a===0?"text-yellow-400":a===1?"text-gray-400":"text-amber-600"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"text-gray-400 text-xs flex items-center gap-1 mb-1 font-bold uppercase",children:[e.jsx(v,{size:10})," Vueltas"]}),e.jsx("div",{className:"font-black text-white",children:r.total_laps})]}),e.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"text-gray-400 text-xs flex items-center gap-1 mb-1 font-bold uppercase",children:[e.jsx(S,{size:10})," Favorito"]}),e.jsx("div",{className:"font-black text-white truncate",title:r.favorite_car,children:r.favorite_car})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[e.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(L,{size:12}),A(new Date(r.last_seen),{addSuffix:!0,locale:D})]}),e.jsxs("div",{className:"text-blue-500 text-xs font-bold flex items-center group-hover:translate-x-1 transition-transform",children:["Ver Pasaporte ",e.jsx(N,{size:14})]})]})]},r.driver_name)):e.jsxs("div",{className:"col-span-full py-20 text-center bg-gray-900/30 rounded-3xl border-2 border-dashed border-gray-800 text-gray-500",children:[e.jsx(o,{size:48,className:"mx-auto mb-4 opacity-10"}),e.jsx("p",{className:"font-bold uppercase tracking-widest text-xs",children:"No hay pilotos registrados"})]})}),t.length>0&&c.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(o,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No se encontraron pilotos con ese nombre."})]})]})}export{K as default};
