import{d as h,u as N,j as e,T as n,a as d,A as v}from"./index-MjGtIaAt.js";import{u as m}from"./useMutation-Ckz2NycH.js";import{T as k}from"./triangle-alert-ko4KflD0.js";const x=`${v}/events`;function A({eventId:s,isAdmin:i=!1}){const u=h(),{data:o,isLoading:b,error:w}=N({queryKey:["bracket",s],queryFn:async()=>(await d.get(`${x}/${s}/bracket`)).data}),f=m({mutationFn:t=>d.post(`${x}/${s}/generate_bracket`,null,{params:{size:t}}),onSuccess:()=>u.invalidateQueries({queryKey:["bracket",s]})}),p=m({mutationFn:({matchId:t,winner:l})=>d.post(`${x}/match/${t}/winner`,null,{params:{winner_name:l,event_id:s}}),onSuccess:()=>u.invalidateQueries({queryKey:["bracket",s]})});if(b)return e.jsxs("div",{className:"p-8 text-center text-white flex flex-col items-center justify-center min-h-[200px]",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-yellow-500/20 border-t-yellow-500 rounded-full animate-spin mb-3"}),e.jsx("p",{className:"font-bold text-yellow-500 animate-pulse uppercase tracking-widest text-xs",children:"Cargando cuadro..."})]});if(w)return e.jsxs("div",{className:"p-8 text-center text-red-500 flex flex-col items-center justify-center min-h-[200px]",children:[e.jsx(k,{size:32,className:"mb-2 opacity-50"}),e.jsx("p",{className:"font-bold uppercase tracking-widest text-xs",children:"Error al cargar el cuadro"})]});const y=o&&"rounds"in o?o:null,a=y?.rounds||[],c=a.length,g=t=>t===c-1?"Final":t===c-2?"Semifinales":t===c-3?"Cuartos de Final":`Ronda ${t+1}`;return e.jsxs("div",{className:"w-full h-full overflow-x-auto p-8",children:[!y||a.length===0?i?e.jsxs("div",{className:"text-center py-12 bg-white/5 rounded-xl border border-white/10",children:[e.jsx(n,{size:48,className:"mx-auto text-yellow-500 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Generar Cuadro del Torneo"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Selecciona el tamaño del cuadro basado en la clasificación actual."}),e.jsx("div",{className:"flex justify-center gap-4",children:[4,8,16].map(t=>e.jsxs("button",{onClick:()=>{confirm(`¿Generar cuadro de ${t} jugadores? Borrará cualquier progreso actual.`)&&f.mutate(t)},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold transition-colors",children:["Top ",t]},t))})]}):e.jsx("div",{className:"text-center text-gray-400 py-12",children:"El cuadro del torneo aún no ha sido generado."}):e.jsx("div",{className:"flex justify-center items-center gap-12 min-w-max",children:Array.isArray(a)&&a.map((t,l)=>e.jsxs("div",{className:"flex flex-col gap-8 relative pt-12",children:[e.jsx("h3",{className:"text-center text-yellow-500 font-bold uppercase tracking-widest mb-4 absolute top-0 left-0 right-0",children:g(l)}),Array.isArray(t)&&[...t].sort((r,j)=>(r.match_num||0)-(j.match_num||0)).map(r=>e.jsx("div",{className:"relative w-64",children:e.jsxs("div",{className:`bg-[#1a1c23] border ${r.winner?"border-yellow-500/50":"border-gray-700"} rounded-lg overflow-hidden shadow-xl`,children:[e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500 px-3 py-1 bg-black/20 border-b border-white/5",children:[e.jsxs("span",{children:["Match #",r.match_num]}),r.winner&&e.jsx("span",{className:"text-green-500",children:"Completado"})]}),e.jsxs("div",{className:`px-4 py-3 border-b border-white/5 flex justify-between items-center cursor-pointer hover:bg-white/5 transition-colors ${r.winner===r.player1?"bg-yellow-500/10":""}`,onClick:()=>i&&r.player1&&p.mutate({matchId:r.id,winner:r.player1}),children:[e.jsx("span",{className:`font-bold ${r.winner===r.player1?"text-yellow-400":"text-gray-300"} ${r.player1?"":"italic text-gray-600"}`,children:r.player1||"BYE"}),r.winner===r.player1&&e.jsx(n,{size:14,className:"text-yellow-400"})]}),e.jsxs("div",{className:`px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-white/5 transition-colors ${r.winner===r.player2?"bg-yellow-500/10":""}`,onClick:()=>i&&r.player2&&p.mutate({matchId:r.id,winner:r.player2}),children:[e.jsx("span",{className:`font-bold ${r.winner===r.player2?"text-yellow-400":"text-gray-300"} ${r.player2?"":"italic text-gray-600"}`,children:r.player2||"BYE"}),r.winner===r.player2&&e.jsx(n,{size:14,className:"text-yellow-400"})]})]})},r.id))]},l))}),Array.isArray(a)&&a.length>0&&Array.isArray(a[a.length-1])&&a[a.length-1][0]?.winner&&e.jsxs("div",{className:"flex flex-col items-center justify-center mt-20 animate-in zoom-in duration-500",children:[e.jsx(n,{size:64,className:"text-yellow-400 mb-4 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]"}),e.jsx("div",{className:"text-sm text-yellow-500 uppercase font-bold tracking-widest mb-2",children:"Campeón"}),e.jsx("div",{className:"text-3xl font-black text-white bg-gradient-to-r from-yellow-600 to-yellow-400 bg-clip-text text-transparent",children:a[a.length-1][0]?.winner})]})]})}export{A as T};
