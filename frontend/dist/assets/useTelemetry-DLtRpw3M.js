import{r as u,R as k,j as f,W as v}from"./index-MjGtIaAt.js";const P={"NÃ¼rburgring Nordschleife":{path:"M 241,475 C 236,470 232,465 228,458 C 218,442 220,438 214,435 C 210,433 205,434 200,443 C 190,460 180,470 165,475 C 145,482 135,478 125,470 C 110,458 100,440 95,420 C 90,400 92,385 102,370 C 115,350 135,335 155,325 C 180,312 210,312 235,320 C 255,327 270,340 280,360 C 290,380 292,395 288,410 C 285,425 275,440 260,455 C 250,465 245,472 241,475 M 241,475 L 350,475 C 370,475 390,465 400,450 C 415,425 420,400 415,370 C 410,340 390,310 360,290 C 330,270 290,265 260,275 C 230,285 200,310 180,340 C 160,370 150,400 155,430 C 160,460 175,485 200,500 C 225,515 255,520 285,515 C 315,510 345,495 365,475 C 385,455 400,430 405,400 C 410,370 405,340 390,310 C 375,280 350,255 320,240 C 290,225 255,220 220,225 C 185,230 150,245 125,270 C 100,295 85,325 80,360 C 75,395 80,430 95,460 C 110,490 135,515 170,530 C 205,545 245,550 285,545 C 325,540 360,525 385,505 C 410,485 430,460 440,430 C 450,400 450,370 440,340 C 430,310 410,280 380,260 C 350,240 310,230 270,235 C 230,240 190,255 160,280 C 130,305 110,335 100,370 C 90,405 90,440 105,475 C 120,510 145,540 180,560 C 215,580 260,585 300,580 C 340,575 380,560 410,535 C 440,510 460,480 470,445 C 480,410 480,370 465,335 C 450,300 425,270 390,250 C 355,230 310,220 265,225 C 220,230 175,245 140,275 C 105,305 80,340 70,380 C 60,420 60,465 75,505 C 90,545 120,580 160,605 C 200,630 250,640 300,635 C 350,630 395,610 430,580 C 465,550 490,510 500,465 C 510,420 505,375 485,335 C 465,295 430,265 385,245 C 340,225 285,220 235,230 C 185,240 140,260 105,295 C 70,330 45,370 35,420 C 25,470 30,520 50,565 C 70,610 105,650 150,675 C 195,700 250,710 305,705 C 360,700 410,680 450,650 C 490,620 520,580 535,530 C 550,480 550,430 535,385 C 510,340 475,305 430,285 C 385,265 330,260 275,270 C 220,280 170,305 130,345 C 90,385 60,435 50,490 C 40,545 45,605 65,655 C 85,705 125,745 175,770 C 225,795 285,805 345,800 C 405,795 460,775 505,740 C 550,705 585,655 600,600 C 615,545 615,485 595,435 C 575,385 535,345 480,325 C 425,305 365,300 305,310 L 241,475",viewBox:"0 0 700 900"}},N=({drivers:x,cars:w,trackName:m})=>{const g=u.useRef(null),c=u.useRef(null),a=k.useMemo(()=>x||(Array.isArray(w)?w.map((n,l)=>({id:n.station_id??l,name:n.driver_name||"Unknown",x:n.x||0,z:n.z||0,normPos:n.n||0,color:"red",isOnline:!0})):[])||[],[x,w]);return u.useEffect(()=>{const n=g.current,l=c.current;if(!n||!l)return;const e=n.getContext("2d");if(!e)return;const s=P[m],C=()=>{const d=window.devicePixelRatio||1,h=l.getBoundingClientRect();n.width=h.width*d,n.height=h.height*d,e.scale(d,d),S()},S=()=>{const d=l.getBoundingClientRect(),h=d.width,p=d.height;e.clearRect(0,0,h,p);const r=h/2,o=p/2,t=s?Math.min(h/600,p/800)*.8:Math.min(h/400,p/300)*1.2,b=()=>{if(s){const i=new Path2D(s.path);e.translate(r-300*t,o-450*t),e.scale(t,t),e.stroke(i),e.scale(1/t,1/t),e.translate(-(r-300*t),-(o-450*t))}else e.moveTo(r-120*t,o-80*t),e.lineTo(r+80*t,o-80*t),e.bezierCurveTo(r+160*t,o-80*t,r+160*t,o+80*t,r+80*t,o+80*t),e.lineTo(r-120*t,o+80*t),e.bezierCurveTo(r-180*t,o+80*t,r-180*t,o-80*t,r-120*t,o-80*t),e.stroke()};e.shadowBlur=0,e.beginPath(),e.strokeStyle="rgba(59, 130, 246, 0.2)",e.lineWidth=35*(s?1:t),e.lineJoin="round",e.lineCap="round",b(),e.beginPath(),e.strokeStyle="#1e293b",e.lineWidth=25*(s?1:t),b(),e.beginPath(),e.strokeStyle="rgba(255,255,255,0.05)",e.lineWidth=22*(s?1:t),b(),e.beginPath(),e.strokeStyle="rgba(255,255,255,0.1)",e.setLineDash([10,15]),e.lineWidth=1,b(),e.setLineDash([]),a.forEach(i=>{if(!i.isOnline)return;const y=r+i.x*(s?t*.5:t*.9),R=o+i.z*(s?t*.5:t*.9);e.shadowBlur=15,e.shadowColor=i.color,e.fillStyle=i.color,e.beginPath(),e.arc(y,R,7*t,0,Math.PI*2),e.fill(),e.shadowBlur=0,e.fillStyle="white",e.beginPath(),e.arc(y,R,3*t,0,Math.PI*2),e.fill();const T=e.measureText(i.name).width+10;e.fillStyle="rgba(0,0,0,0.8)",e.roundRect(y-T/2,R-25*t,T,14*t,4),e.fill(),e.fillStyle="white",e.font=`black ${Math.round(9*t)}px Inter, sans-serif`,e.textAlign="center",e.fillText(i.name,y,R-15*t)})};return C(),window.addEventListener("resize",C),()=>window.removeEventListener("resize",C)},[a,m]),f.jsxs("div",{ref:c,className:"relative w-full h-full bg-transparent overflow-hidden",children:[f.jsxs("div",{className:"absolute top-4 left-6 flex items-center space-x-3 pointer-events-none z-10",children:[f.jsx("div",{className:"flex -space-x-1",children:[1,2,3].map(n=>f.jsx("div",{className:"w-1.5 h-6 bg-yellow-500/20 skew-x-[-20deg]"},n))}),f.jsxs("span",{className:"text-xs uppercase font-black tracking-[0.2em] text-white/20 italic",children:["Vector Intelligence Track: ",m]})]}),f.jsx("canvas",{ref:g,className:"block"})]})},L=()=>{const[x,w]=u.useState({}),[m,g]=u.useState(!1),c=u.useRef(null),a=u.useRef(null);return u.useEffect(()=>{const n=`${v||`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}`}/ws/telemetry/client`,l=()=>{a.current&&clearTimeout(a.current);const e=new WebSocket(n);c.current=e,e.onopen=()=>{g(!0)},e.onclose=s=>{g(!1),s.code!==1e3&&(console.warn(`Telemetry: Closed (${s.code}). Retrying...`),a.current=window.setTimeout(l,3e3))},e.onerror=()=>{console.error("Telemetry: Connection Error")},e.onmessage=s=>{try{const C=JSON.parse(s.data);C.type==="telemetry"&&C.station_id&&w(S=>({...S,[C.station_id]:{...C,timestamp:Date.now()}}))}catch{}}};return l(),()=>{a.current&&window.clearTimeout(a.current),c.current&&(c.current.onclose=null,c.current.onerror=null,(c.current.readyState===WebSocket.OPEN||c.current.readyState===WebSocket.CONNECTING)&&c.current.close(),c.current=null)}},[]),{liveCars:x,isConnected:m}};export{N as L,L as u};
