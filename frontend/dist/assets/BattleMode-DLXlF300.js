import{c as T,f as L,l as O,j as e,r as h,u as S,W as B,T as I,U as P,k as U,a as C,A as E}from"./index-MjGtIaAt.js";import{Q as V}from"./index-BPWuL58u.js";import{m as v}from"./proxy-CbfoYm00.js";import{A as N}from"./activity-d8XIJMYL.js";import{S as R}from"./swords-BObPOtFC.js";import{I as D}from"./info-BJzi6qvF.js";import{Q as q}from"./qr-code-B6KORoVk.js";import{A as M}from"./index-FSCaKcAl.js";import{M as A}from"./map-BRdv7LqT.js";import{C as G}from"./car-Bto1fEN0.js";import{T as F}from"./trash-2-Kfiypbhy.js";import{P as K}from"./plus-Dqq5J1Gg.js";import{X as Q}from"./x-CyrpJdpA.js";const W=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],H=T("flame",W),J=`${B}/ws/telemetry/client`;function Y({onStart:x}){const[s,i]=h.useState(["",""]),[m,g]=h.useState(""),[n,j]=h.useState(""),[l,b]=h.useState(!1),[w,$]=h.useState(!1),{data:k}=S({queryKey:["drivers"],queryFn:async()=>(await C.get(`${E}/telemetry/drivers`)).data}),{data:u}=S({queryKey:["mods","track"],queryFn:async()=>(await C.get(`${E}/mods?type=track`)).data}),{data:_}=S({queryKey:["mods","car"],queryFn:async()=>(await C.get(`${E}/mods?type=car`)).data}),z=Array.isArray(k)?k.map(t=>t.driver_name):[],a=Array.isArray(u)?u:[],r=Array.isArray(_)?_:[],o=()=>{s.length<4&&i([...s,""])},p=t=>{if(s.length>2){const c=[...s];c.splice(t,1),i(c)}},f=(t,c)=>{const d=[...s];d[t]=c,i(d)},y=s.every(t=>t!=="")&&m!==""&&n!=="";return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col items-center justify-start p-4 md:p-8 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-red-900/20 via-gray-950 to-black overflow-y-auto",children:[e.jsxs("div",{className:"w-full max-w-5xl mb-8 flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-red-600 rounded-2xl shadow-[0_0_20px_rgba(220,38,38,0.5)]",children:e.jsx(R,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-black text-white italic tracking-tighter uppercase leading-none",children:["Misión ",e.jsx("span",{className:"text-red-500",children:"Batalla"})]}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Compite. Compara. Domina."})]})]}),e.jsxs("button",{onClick:()=>$(!w),className:"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl text-gray-300 transition-colors",children:[e.jsx(D,{size:18}),e.jsx("span",{children:"¿Cómo funciona?"})]})]}),e.jsx(M,{children:w&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"w-full max-w-5xl mb-8 overflow-hidden",children:e.jsxs("div",{className:"bg-blue-600/10 border border-blue-500/30 p-6 rounded-3xl grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-blue-400 font-bold flex items-center gap-2",children:[e.jsx(P,{size:18})," 1. Multijugador"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Selecciona hasta 4 pilotos para comparar sus tiempos y telemetría en tiempo real."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-blue-400 font-bold flex items-center gap-2",children:[e.jsx(A,{size:18})," 2. Desafío Directo"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Elige el circuito y el coche. El sistema buscará los mejores tiempos históricos de cada piloto."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-blue-400 font-bold flex items-center gap-2",children:[e.jsx(N,{size:18})," 3. Telemetría en Vivo"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Durante la carrera, verás la velocidad, marcha y distancias exactas entre cada contendiente."})]})]})})}),e.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 lg:grid-cols-12 gap-8 mb-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-6",children:e.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-xl p-8 rounded-3xl border border-gray-800 shadow-xl space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx(N,{className:"text-red-500"})," Configuración Escenario"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest pl-1",children:"Circuito"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",size:20}),e.jsxs("select",{className:"w-full bg-gray-800 border-2 border-transparent focus:border-red-500/50 rounded-2xl pl-12 pr-4 py-4 text-white font-bold outline-none appearance-none transition-all cursor-pointer",value:m,onChange:t=>g(t.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Circuito..."}),a.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest pl-1",children:"Vehículo"}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",size:20}),e.jsxs("select",{className:"w-full bg-gray-800 border-2 border-transparent focus:border-red-500/50 rounded-2xl pl-12 pr-4 py-4 text-white font-bold outline-none appearance-none transition-all cursor-pointer",value:n,onChange:t=>j(t.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Coche..."}),r.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]})]})]})]})}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-xl p-8 rounded-3xl border border-gray-800 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx(P,{className:"text-blue-500"})," Contendientes"]}),e.jsxs("span",{className:"bg-white/10 px-3 py-1 rounded-full text-xs font-black text-gray-400",children:[s.length," / 4"]})]}),e.jsxs("div",{className:"space-y-3",children:[s.map((t,c)=>e.jsxs(v.div,{layout:!0,initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center font-black text-white ${c===0?"bg-blue-600 shadow-[0_0_15px_rgba(37,99,235,0.4)]":c===1?"bg-red-600 shadow-[0_0_15px_rgba(220,38,38,0.4)]":c===2?"bg-yellow-600 shadow-[0_0_15px_rgba(202,138,4,0.4)]":"bg-purple-600 shadow-[0_0_15px_rgba(147,51,234,0.4)]"}`,children:c+1}),e.jsx("div",{className:"flex-1 relative",children:e.jsxs("select",{className:"w-full bg-gray-800 border-2 border-transparent focus:border-white/20 rounded-xl px-4 py-4 text-white font-bold outline-none transition-all cursor-pointer",value:t,onChange:d=>f(c,d.target.value),children:[e.jsx("option",{value:"",children:"Elegir Piloto..."}),z.filter(d=>!s.includes(d)||d===t).map(d=>e.jsx("option",{value:d,children:d},d))]})}),s.length>2&&e.jsx("button",{onClick:()=>p(c),className:"p-4 bg-gray-800 hover:bg-red-900/30 text-gray-500 hover:text-red-500 rounded-xl transition-all",children:e.jsx(F,{size:20})})]},`player-slot-${c}`)),s.length<4&&e.jsxs("button",{onClick:o,className:"w-full py-4 border-2 border-dashed border-gray-800 hover:border-gray-600 rounded-xl text-gray-500 hover:text-gray-300 font-bold flex items-center justify-center gap-2 transition-all mt-2",children:[e.jsx(K,{size:20})," Añadir Piloto"]})]})]}),e.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-xl p-4 rounded-2xl border border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${l?"bg-orange-500/20 text-orange-400":"bg-gray-800 text-gray-500"}`,children:e.jsx(N,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:"Modo Simulación"}),e.jsx("div",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:"Generar telemetría de prueba"})]})]}),e.jsx("button",{onClick:()=>b(!l),className:`w-12 h-6 rounded-full transition-all relative ${l?"bg-orange-600 shadow-[0_0_10px_rgba(234,88,12,0.4)]":"bg-gray-700"}`,children:e.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${l?"left-7":"left-1"}`})})]}),e.jsxs("button",{disabled:!y,onClick:()=>x(s,m,n,l),className:"w-full bg-gradient-to-r from-red-600 to-orange-600 hover:from-orange-500 hover:to-red-500 disabled:opacity-30 disabled:grayscale text-white font-black text-2xl py-6 rounded-3xl shadow-[0_10px_40px_rgba(220,38,38,0.3)] transition-all transform hover:scale-[1.02] active:scale-95 uppercase tracking-widest flex items-center justify-center gap-3 overflow-hidden relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700 skew-x-[-20deg]"}),e.jsx(H,{className:"w-8 h-8 group-hover:animate-bounce"}),"Iniciar Batalla",e.jsx(U,{className:"w-6 h-6 group-hover:translate-x-2 transition-transform"})]}),e.jsx("p",{className:"text-center text-gray-600 text-sm font-bold uppercase tracking-widest",children:"Transmisión 4K · Sistema Live Telemetry Pro v2"})]})]})]})}function X({query:x}){const s=x.get("drivers"),i=h.useMemo(()=>s?JSON.parse(s):[],[s]),m=x.get("track"),g=x.get("car"),n=x.get("isDemo")==="true",[j,l]=h.useState({}),{data:b,isLoading:w,error:$}=S({queryKey:["battle",i,m,g],queryFn:async()=>(await C.post(`${E}/telemetry/compare-multi`,{drivers:i,track:m,car:g})).data,refetchInterval:n?!1:1e4});if(h.useEffect(()=>{if(!n)return;const a=setInterval(()=>{l(r=>{const o={...r};return i.forEach(p=>{const f=r[p]||{speed:0,normalized_pos:0},y=(Math.random()-.45)*10;let t=Math.round(Number(f.speed||0)+y);t>280&&(t=275),t<40&&(t=45);const c=t>240?6:t>200?5:t>160?4:t>120?3:t>80?2:1,d=(Number(f.normalized_pos||0)+t/5e4)%1;o[p]={speed:t,gear:c,normalized_pos:d}}),o})},100);return()=>clearInterval(a)},[n,i]),h.useEffect(()=>{if(n)return;const a=new WebSocket(J);return a.onmessage=r=>{try{const o=JSON.parse(r.data),p=o.driver_name||o.driver;i.includes(p)&&l(f=>({...f,[p]:o}))}catch{}},()=>a.close()},[i,n]),w)return e.jsxs("div",{className:"min-h-screen bg-black flex flex-col items-center justify-center text-white text-3xl font-black gap-6 uppercase tracking-[1em] italic overflow-hidden",children:[e.jsx(v.div,{animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:1},children:e.jsx(N,{className:"w-20 h-20 text-red-500"})}),"Sincronizando Satélites..."]});if($)return e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center text-red-500 font-bold",children:"Error: Datos insuficientes para generar la batalla"});if(!b)return null;const k=a=>{if(!a||a>9999999)return"--:--.---";const r=Math.floor(a/6e4),o=Math.floor(a%6e4/1e3),p=a%1e3;return`${r}:${o.toString().padStart(2,"0")}.${p.toString().padStart(3,"0")}`},u=["text-blue-400","text-red-400","text-yellow-400","text-purple-400"],_=["border-blue-500/30","border-red-500/30","border-yellow-500/30","border-purple-500/30"],z=["from-blue-900/20","from-red-900/20","from-yellow-900/20","from-purple-900/20"];return e.jsxs("div",{className:"min-h-screen bg-black text-white overflow-hidden flex flex-col relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('/grid-dark.png')] opacity-10 pointer-events-none"}),e.jsxs("header",{className:"relative z-10 p-6 flex justify-between items-center border-b border-white/5 bg-gray-900/50 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-yellow-500 rounded-lg",children:e.jsx(R,{className:"w-6 h-6 text-black"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-black uppercase italic leading-none",children:["Battle Arena ",e.jsx("span",{className:"text-yellow-500 font-mono text-sm ml-2",children:"PRO LIVE"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-0.5 rounded font-mono uppercase",children:m}),e.jsx("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-0.5 rounded font-mono uppercase",children:g})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black tracking-widest leading-none",children:"SERVER UPTIME"}),e.jsx("span",{className:"text-xs font-mono text-green-500",children:"99.9% STABLE"})]}),e.jsxs("div",{className:"px-4 py-2 bg-red-600/10 border border-red-500/20 rounded-full flex items-center gap-2",children:[e.jsx(N,{className:"w-3 h-3 text-red-500 animate-pulse"}),e.jsx("span",{className:"text-red-500 font-black italic tracking-widest text-[10px]",children:"LIVE BROADCAST"})]})]})]}),e.jsx("main",{className:`flex-1 relative z-10 grid p-4 gap-4 ${i.length>2?"grid-cols-2 grid-rows-2":"grid-cols-1 md:grid-cols-2"}`,children:b.drivers.map((a,r)=>{const o=j[a.driver_name]||{},p=a.best_lap>0&&a.best_lap===Math.min(...b.drivers.map(y=>y.best_lap).filter(y=>y>1e3)),f=a.total_laps>0;return e.jsxs(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:`relative rounded-3xl border-2 ${_[r]} bg-gradient-to-br ${z[r]} to-black/80 overflow-hidden group p-6 flex flex-col justify-between`,children:[e.jsxs("div",{className:"relative z-10 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`p-1 px-3 rounded-full bg-white/5 border border-white/10 text-[10px] font-black tracking-[0.2em] mb-2 inline-block ${u[r]}`,children:["P",r+1," CONTEMPORARY"]}),e.jsx("h2",{className:"text-4xl md:text-5xl font-black uppercase leading-none italic tracking-tighter mb-4 truncate max-w-[250px]",children:a.driver_name})]}),p&&e.jsx("div",{className:"p-3 bg-yellow-500 rounded-2xl shadow-[0_0_30px_rgba(234,179,8,0.3)] animate-bounce",children:e.jsx(I,{size:24,className:"text-black"})})]}),e.jsxs("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:[f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black tracking-widest",children:"BEST LAP"}),e.jsx("span",{className:`text-3xl md:text-4xl font-mono font-black italic ${u[r]}`,children:k(a.best_lap)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black tracking-widest",children:"CONSISTENCY"}),e.jsxs("span",{className:"text-xl font-mono font-bold text-white",children:[a.consistency.toFixed(1)," ",e.jsx("span",{className:"text-xs text-gray-500",children:"ms var"})]})]})]}):e.jsxs("div",{className:"flex flex-col justify-center items-center bg-white/5 rounded-2xl border border-white/5 p-4 text-center",children:[e.jsx(D,{className:"text-gray-600 mb-2",size:24}),e.jsx("span",{className:"text-[10px] text-gray-500 font-black tracking-widest leading-tight",children:"SIN REGISTROS"}),e.jsx("p",{className:"text-[9px] text-gray-600 mt-1 uppercase",children:"Marca tu primer tiempo ahora"})]}),e.jsxs("div",{className:"bg-black/60 backdrop-blur-md rounded-2xl p-4 border border-white/5 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black",children:"LIVE SPEED"}),e.jsxs("span",{className:`font-mono font-black text-lg ${u[r]}`,children:[o.speed||0," ",e.jsx("span",{className:"text-[10px]",children:"KM/H"})]})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black",children:"GEAR"}),e.jsx("span",{className:"font-mono font-black text-xl text-white",children:o.gear||"N"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black",children:"PROGRESS"}),e.jsx("div",{className:"flex-1 ml-4 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-current ${u[r]} transition-all duration-500`,style:{width:`${(o.normalized_pos||0)*100}%`}})})]})]})]}),e.jsx("div",{className:`absolute -bottom-10 -right-10 text-[10rem] font-black opacity-5 pointer-events-none italic ${u[r]}`,children:r+1})]},a.driver_name)})}),e.jsxs("footer",{className:"relative z-10 p-4 border-t border-white/5 bg-gray-900/80 flex justify-between items-center px-10",children:[e.jsxs("div",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:["Assetto Manager Arena © 2026 · ",e.jsx("span",{className:"text-gray-400 italic",children:"Push the limits"})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx("button",{className:"text-gray-500 hover:text-white transition-colors",children:e.jsx(q,{size:18})})})]}),e.jsx(Z,{stats:b,drivers:i})]})}function Z({stats:x,drivers:s}){const[i,m]=h.useState(!1);if(h.useEffect(()=>{const l=setTimeout(()=>m(!0),45e3);return()=>clearTimeout(l)},[]),!i)return null;const g=x.drivers.filter(l=>l.best_lap>1e3),n=g.length>0?g.reduce((l,b)=>l.best_lap<b.best_lap?l:b).driver_name:s[0],j=`${window.location.origin}/p/${encodeURIComponent(n)}`;return e.jsx(M,{children:e.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-xl flex items-center justify-center p-8",children:e.jsxs(v.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-gradient-to-br from-gray-900 to-black border-4 border-yellow-500/30 rounded-[3rem] p-12 max-w-2xl w-full text-center relative shadow-[0_0_100px_rgba(234,179,8,0.2)]",children:[e.jsx("button",{onClick:()=>m(!1),className:"absolute top-8 right-8 text-gray-500 hover:text-white transition-colors",children:e.jsx(Q,{size:32})}),e.jsxs("div",{className:"relative inline-block mb-10",children:[e.jsx(I,{className:"w-24 h-24 text-yellow-500 mx-auto animate-pulse"}),e.jsx(v.div,{animate:{rotate:360},transition:{repeat:1/0,duration:10,ease:"linear"},className:"absolute inset-0 border-4 border-dashed border-yellow-500/20 rounded-full scale-150"})]}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-2 italic",children:"Victoria Magistral"}),e.jsx("div",{className:"text-6xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-500 to-yellow-400 uppercase mb-10 tracking-tighter italic",children:n}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8 bg-white/5 p-8 rounded-[2rem] border border-white/10 mb-8",children:[e.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-2xl",children:e.jsx(V,{value:j,size:150,level:"H",includeMargin:!1})}),e.jsxs("div",{className:"text-left space-y-3",children:[e.jsx("h4",{className:"text-xl font-bold text-white",children:"Guarda tu Legado"}),e.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:"Escanea este código para registrar tu victoria en tu **Pasaporte Piloto** público y compartir el resultado con tus amigos."}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-yellow-500 font-black tracking-widest uppercase bg-yellow-500/10 px-3 py-1 rounded-full w-fit",children:[e.jsx(N,{size:10})," Link Permanente"]})]})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-gray-500 hover:text-white font-bold uppercase tracking-widest text-xs transition-colors",children:"Volver a Configurar"})]})})})}function pe(){const[x]=L(),s=O();return x.get("drivers")&&x.get("track")?e.jsx(X,{query:x}):e.jsx(Y,{onStart:(m,g,n,j)=>{const l=JSON.stringify(m);s(`?drivers=${encodeURIComponent(l)}&track=${encodeURIComponent(g)}&car=${encodeURIComponent(n)}${j?"&isDemo=true":""}`)}})}export{pe as default};
