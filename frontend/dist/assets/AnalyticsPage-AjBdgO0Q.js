import{c as k,r as C,u as n,j as e,C as N,a as l,A as c}from"./index-MjGtIaAt.js";import{B as y}from"./badge-dollar-sign-Du8r7ZRT.js";import{T as h}from"./trending-up-BHF8h5rZ.js";import{C as b}from"./clock-DpL4IKBu.js";import{R as x,X as f}from"./CartesianChart-byA6CRUy.js";import{B as w,a as A,C as _}from"./BarChart-DzL7O3Yf.js";import{C as j}from"./getRadiusAndStrokeWidthFromDot-hhzSCn0X.js";import{Y as v}from"./YAxis-hjvaWDO6.js";import{T as m}from"./Tooltip-BKNbpHsn.js";import{a as $,A as S}from"./AreaChart-B6ltY9AV.js";import{P as F,a as z}from"./PieChart-D-40hrae.js";import{L as B}from"./Legend-DL5FTiQX.js";import"./clsx-B-dksMZM.js";import"./graphicalItemSelectors-DfVAs9is.js";import"./PolarChart-BobUyqbt.js";const K=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],I=k("credit-card",K),P=async s=>(await l.get(`${c}/analytics/revenue?range_days=${s}`)).data,D=async s=>(await l.get(`${c}/analytics/utilization?range_days=${s}`)).data,q=async s=>(await l.get(`${c}/analytics/kpi?range_days=${s}`)).data,R=async s=>(await l.get(`${c}/analytics/payment-methods?range_days=${s}`)).data;function ee(){const[s,a]=C.useState(30),{data:d}=n({queryKey:["analytics-revenue",s],queryFn:()=>P(s)}),{data:o}=n({queryKey:["analytics-utilization",s],queryFn:()=>D(s)}),{data:r}=n({queryKey:["analytics-kpi",s],queryFn:()=>q(s)}),{data:g}=n({queryKey:["analytics-payment-methods",s],queryFn:()=>R(s)});return e.jsxs("div",{className:"p-8 max-w-[1600px] mx-auto min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-end mb-8 border-b border-gray-800 pb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black text-white tracking-tight flex items-center gap-3",children:[e.jsx(y,{className:"text-green-500",size:32}),"ANÁLISIS DE NEGOCIO"]}),e.jsx("p",{className:"text-gray-400 mt-1 font-medium",children:"Métricas de rendimiento financiero y operativo"})]}),e.jsx("div",{className:"flex bg-gray-900 rounded-lg p-1 border border-gray-800",children:[7,30,90,365].map(t=>e.jsx("button",{onClick:()=>a(t),className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${s===t?"bg-gray-800 text-white shadow-sm":"text-gray-500 hover:text-gray-300"}`,children:t===365?"1 Año":`${t} Días`},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10",children:[e.jsx(i,{label:"Ingresos Totales",value:r?.total_revenue?`€${r.total_revenue.toLocaleString()}`:"€0",icon:y,color:"green"}),e.jsx(i,{label:"Sesiones Vendidas",value:r?.total_sessions||"0",icon:N,color:"blue"}),e.jsx(i,{label:"Ticket Medio",value:r?.avg_ticket?`€${r.avg_ticket}`:"€0",icon:h,color:"purple"}),e.jsx(i,{label:"Ingreso / Sesión",value:r?.revenue_per_session?`€${r.revenue_per_session}`:"€0",icon:b,color:"orange"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-900/50 border border-gray-800 rounded-2xl p-6 backdrop-blur-sm",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(h,{size:20,className:"text-green-400"})," Evolución de Ingresos"]}),e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(w,{data:d||[],children:[e.jsx(j,{strokeDasharray:"3 3",stroke:"#374151",opacity:.5}),e.jsx(f,{dataKey:"date",stroke:"#9CA3AF",fontSize:12,tickFormatter:t=>t.slice(5)}),e.jsx(v,{stroke:"#9CA3AF",fontSize:12}),e.jsx(m,{contentStyle:{backgroundColor:"#111827",borderColor:"#374151",color:"#fff"},itemStyle:{color:"#fff"}}),e.jsx(A,{dataKey:"revenue",fill:"#10B981",radius:[4,4,0,0],name:"Ingresos (€)"})]})})})]}),e.jsxs("div",{className:"bg-gray-900/50 border border-gray-800 rounded-2xl p-6 backdrop-blur-sm",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(b,{size:20,className:"text-blue-400"})," Horas de Mayor Actividad"]}),e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs($,{data:o||[],children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCount",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),e.jsx(j,{strokeDasharray:"3 3",stroke:"#374151",opacity:.5}),e.jsx(f,{dataKey:"hour",stroke:"#9CA3AF",fontSize:12,tickFormatter:t=>`${t}:00`}),e.jsx(v,{stroke:"#9CA3AF",fontSize:12}),e.jsx(m,{contentStyle:{backgroundColor:"#111827",borderColor:"#374151",color:"#fff"},itemStyle:{color:"#fff"}}),e.jsx(S,{type:"monotone",dataKey:"count",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorCount)",name:"Sesiones"})]})})})]}),e.jsxs("div",{className:"bg-gray-900/50 border border-gray-800 rounded-2xl p-6 backdrop-blur-sm col-span-1 lg:col-span-2 xl:col-span-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(I,{size:20,className:"text-purple-400"})," Métodos de Pago"]}),e.jsx("div",{className:"h-[300px] w-full flex items-center justify-center",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(F,{children:[e.jsx(z,{data:g||[],cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"revenue",nameKey:"method",children:(g||[]).map((t,p)=>{const u={cash:"#10B981",card_nayax:"#8B5CF6",online:"#3B82F6",unknown:"#6B7280"};return e.jsx(_,{fill:u[t.method]||u.unknown},`cell-${p}`)})}),e.jsx(m,{formatter:t=>`€${t}`,contentStyle:{backgroundColor:"#111827",borderColor:"#374151",color:"#fff"}}),e.jsx(B,{formatter:t=>({cash:"Efectivo",card_nayax:"TPV / Tarjeta",online:"Web / Online",unknown:"Desconocido"})[t]||t})]})})})]})]})]})}function i({label:s,value:a,icon:d,color:o}){const r={green:"text-green-400 bg-green-500/10 border-green-500/20",blue:"text-blue-400 bg-blue-500/10 border-blue-500/20",purple:"text-purple-400 bg-purple-500/10 border-purple-500/20",orange:"text-orange-400 bg-orange-500/10 border-orange-500/20"};return e.jsxs("div",{className:`p-6 rounded-2xl border ${r[o]} flex items-center justify-between`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-1",children:s}),e.jsx("h3",{className:"text-3xl font-black text-white",children:a})]}),e.jsx("div",{className:`p-3 rounded-xl bg-black/20 ${r[o].split(" ")[0]}`,children:e.jsx(d,{size:32})})]})}export{ee as default};
